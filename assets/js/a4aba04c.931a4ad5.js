"use strict";(self.webpackChunklinkis_web_apache=self.webpackChunklinkis_web_apache||[]).push([[57833],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return h}});var i=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=i.createContext({}),l=function(e){var t=i.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=l(e.components);return i.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,p=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),m=l(n),h=a,u=m["".concat(p,".").concat(h)]||m[h]||d[h]||r;return n?i.createElement(u,s(s({ref:t},c),{},{components:n})):i.createElement(u,s({ref:t},c))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,s=new Array(r);s[0]=m;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:a,s[1]=o;for(var l=2;l<r;l++)s[l]=n[l];return i.createElement.apply(null,s)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},41212:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return o},contentTitle:function(){return p},metadata:function(){return l},toc:function(){return c},default:function(){return m}});var i=n(87462),a=n(63366),r=(n(67294),n(3905)),s=["components"],o={title:"Installation and deployment of tool scriptis",sidebar_position:10},p=void 0,l={unversionedId:"deployment/linkis-scriptis-install",id:"version-1.1.2/deployment/linkis-scriptis-install",isDocsHomePage:!1,title:"Installation and deployment of tool scriptis",description:"1. introduce",source:"@site/versioned_docs/version-1.1.2/deployment/linkis-scriptis-install.md",sourceDirName:"deployment",slug:"/deployment/linkis-scriptis-install",permalink:"/docs/1.1.2/deployment/linkis-scriptis-install",editUrl:"https://github.com/apache/incubator-linkis-website/edit/dev/versioned_docs/version-1.1.2/deployment/linkis-scriptis-install.md",tags:[],version:"1.1.2",sidebarPosition:10,frontMatter:{title:"Installation and deployment of tool scriptis",sidebar_position:10},sidebar:"version-1.1.2/tutorialSidebar",previous:{title:"Deploy Linkis without HDFS",permalink:"/docs/1.1.2/deployment/deploy-linkis-without-hdfs"},next:{title:"Overview",permalink:"/docs/1.1.2/user-guide/overview"}},c=[{value:"1. introduce",id:"1-introduce",children:[]}],d={toc:c};function m(e){var t=e.components,o=(0,a.Z)(e,s);return(0,r.kt)("wrapper",(0,i.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"1-introduce"},"1. introduce"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"On linkis1.0 and DSS 1.1 After X, scriptpis can be deployed separately to integrate with linkis. Using the interactive analysis function of scriptis, you can write SQL, pyspark, hiveql and other scripts online on the web page, submit them to linkis for execution, and support UDF, functions, resource control, user-defined variables and other features. This article will introduce how to deploy the web component scriptis separately, and use linkis through such a web page as scriptis.")),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"be careful")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Premise: the linkis service (back-end and management console services) has been successfully installed and can be used normally. See ","[rapid deployment of linkis]"," (deployment/quick-deploy) for the deployment process of linkis\nExample description:"),(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},"The address of the linkis gateway service is 10.10.10.10 and the port is 9001"),(0,r.kt)("li",{parentName:"ul"},"The management console nginx of linkis is deployed on port 8080 of 10.10.10.10\n:::")),(0,r.kt)("h2",{parentName:"div",id:"2-compilation-process"},"2. Compilation process"),(0,r.kt)("h3",{parentName:"div",id:"21-install-node-js"},"2.1 Install node js"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-shell",metastring:"script",script:!0},"     Set node JS download and install. Download address: http://nodejs.cn/download/ (it is recommended to use the latest stable version) this step is only required for the first use\n")),(0,r.kt)("h3",{parentName:"div",id:"21-install-learn"},"2.1 install learn"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-shell",metastring:"script",script:!0},"   #The computer opens the CMD terminal tool and enters the command for global installation\n   npm install lerna -g\n")),(0,r.kt)("p",{parentName:"div"},"Wait until the installation is completed. The installation of liarn only needs to be performed when it is used for the first time"),(0,r.kt)("h3",{parentName:"div",id:"22-get-scripts-code"},"2.2 Get scripts code"),(0,r.kt)("blockquote",{parentName:"div"},(0,r.kt)("p",{parentName:"blockquote"},"Scriptis is a pure front-end project, which is integrated into the DSS web code component as a component. We only need to compile the DSS web project with a separate scripts module")),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-shell",metastring:"script",script:!0},"#Before downloading the official version of DSS 1.1.0 through GIT and releasing it, it is recommended to use the dev-1.1.4 branch of this branch to compile the scripts component\ngit clone  -b dev-1.1.4 https://github.com/WeDataSphere/DataSphereStudio\n# Or download the zip package directly and unzip it\nhttps://codeload.github.com/WeDataSphere/DataSphereStudio/zip/refs/heads/dev-1.1.4\n\n#Enter web directory\ncd DataSphereStudio/web \n\n#Add dependency note: learn needs to be installed in lerna bootstrap instead of NPM install. This step needs to be performed only for the first time\nlerna bootstrap\n")),(0,r.kt)("h3",{parentName:"div",id:"23-local-operation-project"},"2.3 Local operation project"),(0,r.kt)("blockquote",{parentName:"div"},(0,r.kt)("p",{parentName:"blockquote"},"If you do not want to run the view locally, you can skip this step")),(0,r.kt)("h4",{parentName:"div",id:"231-configure-the-linkis-gateway-service-address-configuration"},"2.3.1 Configure the linkis gateway service address configuration"),(0,r.kt)("p",{parentName:"div"},"If the service is started locally, you need to configure the back-end linkis gateway service address in the code, which is in the ",(0,r.kt)("inlineCode",{parentName:"p"},". Under the web/packages/dss/ directory Env")," file,\nConfiguration is not required when packaging deployment"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-shell",metastring:"script",script:!0},"// Backend linkis gatway service address\nVUE_APP_HOST=http://10.10.10.10:9001\nVUE_APP_MN_CONFIG_PREFIX=http://10.10.10.10:9001/api/rest_j/v1\n")),(0,r.kt)("h4",{parentName:"div",id:"232-running-scripts-module"},"2.3.2 Running scripts module"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-shell",metastring:"script",script:!0},"cd DataSphereStudio/web \n# Run scripts component \nnpm run serve --module=scriptis\n")),(0,r.kt)("p",{parentName:"div"},"Open the browser and link",(0,r.kt)("inlineCode",{parentName:"p"},"http://localhost:8080"),"(the default port for the local request is 8080) to access the application scripts, because it will request the remote linkis gatway service interface, which will have a cross domain problem. To solve the cross domain problem for the Chrome browser, please refer to ","[solve the chrome cross domain problem]","\uff08 ",(0,r.kt)("a",{parentName:"p",href:"https://www.jianshu.com/p/56b1e01e6b6a"},"https://www.jianshu.com/p/56b1e01e6b6a")," )"),(0,r.kt)("h2",{parentName:"div",id:"3-packaging--deployment-scriptis"},"3. Packaging ","&"," Deployment scriptis"),(0,r.kt)("h3",{parentName:"div",id:"31--pack"},"3.1  pack"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-shell",metastring:"script",script:!0},"#Specify scripts module\ncd DataSphereStudio/web \n\n#After the instruction is successfully executed, a folder named 'dist' will appear in the web directory, which is the component resource code of packaged scripts. We need to deploy this front-end resource to the nginx server where linkis web is located\nnpm run build --module=scriptis \n")),(0,r.kt)("h3",{parentName:"div",id:"32-deploy"},"3.2 deploy"),(0,r.kt)("p",{parentName:"div"},"Upload the static resources compiled in 3.1 to the server where the linkis management console is located, and store them in ",(0,r.kt)("inlineCode",{parentName:"p"},"/data/install/scripts-web/dist/"),",\nAdd the static resource access rules of scripts to the nginx server configuration for installing the linkis management console. The nginx configuration deployed by the linkis management console is generally located in ",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/nginx/conf.d/linkis conf")),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-shell",metastring:"script",script:!0}," location /scriptis { \n     alias      /data/Install/scriptis-web/dist/ ;\n     index     index.html ;\n}\n")),(0,r.kt)("p",{parentName:"div"},"sudo vim ",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/nginx/conf.d/linkis.conf")),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-shell",metastring:"script",script:!0},"server {\n            listen       8080;# Access port\n            server_name  localhost;\n            #charset koi8-r;\n            #access_log  /var/log/nginx/host.access.log  main;\n\n            location / {\n             root    /appcom/Install/linkis-web/dist/; # Static file directory\n             index   index.html;\n            }\n\n           location /scriptis {  #The resources of scripts are prefixed with scripts to distinguish them from the linkis management console\n             alias        /data/Install/scriptis-web/dist/  ;  #Nginx scripts static file storage path (customizable)\n             index     index.html ;\n            }\n\n        .......\n\nlocation /api {\n            proxy_pass http://10.10.10.10:9001; #Address of gatway\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header x_real_ipP $remote_addr;\n            proxy_set_header remote_addr $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_http_version 1.1;\n            proxy_connect_timeout 4s;\n            proxy_read_timeout 600s;\n            proxy_send_timeout 12s;\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection upgrade;\n            }\n\n            #error_page  404              /404.html;\n            # redirect server error pages to the static page /50x.html\n            #\n            error_page   500 502 503 504  /50x.html;\n            location = /50x.html {\n            root   /usr/share/nginx/html;\n            }\n        }\n\n")),(0,r.kt)("p",{parentName:"div"},"After modifying the configuration, reload the nginx configuration"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-shell",metastring:"script",script:!0},"sudo nginx -s reload\n")),(0,r.kt)("p",{parentName:"div"},"Note the difference between root and alias in nginx"),(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},"The result of root processing is: root path + location path"),(0,r.kt)("li",{parentName:"ul"},"The result of alias processing is to replace the location path with the alias path"),(0,r.kt)("li",{parentName:"ul"},"Alias is the definition of a directory alias, and root is the definition of the top-level directory")),(0,r.kt)("h2",{parentName:"div",id:"4-scriptis-use-steps"},"4. scriptis Use steps"),(0,r.kt)("h3",{parentName:"div",id:"41-log-in-to-the-linkis-management-console-normally"},"4.1 Log in to the linkis management console normally"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-shell",metastring:"script",script:!0},"#http://10.10.10.10:8080/#/\nhttp://nginxIp:port/#/\n")),(0,r.kt)("p",{parentName:"div"},"Because scripts requires login verification, you need to log in first to get the cookie."),(0,r.kt)("h3",{parentName:"div",id:"42-visit-the-scripts-page-after-successful-login"},"4.2 Visit the scripts page after successful login"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-shell",metastring:"script",script:!0},"#http://10.10.10.10:8080/scriptis/\nhttp://nginxIp:port/scriptis/\n")),(0,r.kt)("p",{parentName:"div"},"Nginxip:nginx server IP, port:linkis management console nginx configuration start port number, ",(0,r.kt)("inlineCode",{parentName:"p"},"scripts")," is the location address configured for the static file nginx of the requested scripts project (customizable)"),(0,r.kt)("h3",{parentName:"div",id:"43-use-scriptis"},"4.3 use scriptis"),(0,r.kt)("p",{parentName:"div"},"Take creating an SQL query task as an example."),(0,r.kt)("p",{parentName:"div"},"step1 New script"),(0,r.kt)("p",{parentName:"div"},(0,r.kt)("img",{alt:"design sketch",src:n(79900).Z})),(0,r.kt)("p",{parentName:"div"},"step2 Enter the statement to query"),(0,r.kt)("p",{parentName:"div"},(0,r.kt)("img",{alt:"design sketch",src:n(98967).Z})),(0,r.kt)("p",{parentName:"div"},"step3 function"),(0,r.kt)("p",{parentName:"div"},(0,r.kt)("img",{alt:"design sketch",src:n(18407).Z})),(0,r.kt)("p",{parentName:"div"},"shep4 View results"),(0,r.kt)("p",{parentName:"div"},(0,r.kt)("img",{alt:"design sketch",src:n(56811).Z})))))}m.isMDXComponent=!0},56811:function(e,t,n){t.Z=n.p+"assets/images/design_sketch-5a7e1807d1f587129e33b863c1da1418.png"},79900:function(e,t,n){t.Z=n.p+"assets/images/new_script-f73ee84fe932d7d4cc43c40408405722.png"},18407:function(e,t,n){t.Z=n.p+"assets/images/running_results-b181b4b3a60bc22c7a1bfc72356b165b.png"},98967:function(e,t,n){t.Z=n.p+"assets/images/test_statement-0ed452eb88b6c3f9a9bb89fe06901c3b.png"}}]);