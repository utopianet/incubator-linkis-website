<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Linkis Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Linkis Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Apache Linkis" href="/opensearch.xml"><title data-react-helmet="true">Blog | Apache Linkis</title><meta data-react-helmet="true" property="og:title" content="Blog | Apache Linkis"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="description" content="Blog"><meta data-react-helmet="true" property="og:description" content="Blog"><meta data-react-helmet="true" property="og:url" content="https://linkis.incubator.apache.org/blog"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://linkis.incubator.apache.org/blog"><link data-react-helmet="true" rel="alternate" href="https://linkis.incubator.apache.org/blog" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://linkis.incubator.apache.org/zh-CN/blog" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://linkis.incubator.apache.org/blog" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://AE29KQB3IA-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.43be7c54.css">
<link rel="preload" href="/assets/js/runtime~main.8c2fcd23.js" as="script">
<link rel="preload" href="/assets/js/main.ffdafd4c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Apache Linkis Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo.png" alt="Apache Linkis Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Apache Linkis(Incubating)</b></a><a class="navbar__item navbar__link" href="/download/main">Download</a><a class="navbar__item navbar__link" href="/community/how-to-subscribe">Community</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/team">Team</a><a class="navbar__item navbar__link" href="/user">Users</a><a class="navbar__item navbar__link" href="/faq/main">FAQ</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link">ASF</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Foundation</a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">License</a></li><li><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="dropdown__link">Events</a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Security</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Sponsorship</a></li><li><a href="https://www.apache.org/foundation/policies/privacy.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy</a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Thanks</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link">Doc</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/latest/introduction">1.3.0</a></li><li><a class="dropdown__link" href="/docs/1.2.0/introduction">1.2.0</a></li><li><a class="dropdown__link" href="/docs/1.1.3/introduction">1.1.3</a></li><li><a class="dropdown__link" href="/docs/1.1.2/introduction">1.1.2</a></li><li><a class="dropdown__link" href="/docs/1.1.1/introduction">1.1.1</a></li><li><a class="dropdown__link" href="/docs/1.1.0/introduction">1.1.0</a></li><li><a class="dropdown__link" href="/docs/1.0.3/introduction">1.0.3</a></li><li><a class="dropdown__link" href="/docs/1.0.2/introduction">1.0.2</a></li><li><a class="dropdown__link" href="/docs/0.11.0/introduction">0.11.0</a></li><li><a class="dropdown__link" href="/docs/1.3.1/introduction">Next(1.3.1)</a></li><li><a class="dropdown__link" href="/versions">All Version</a></li></ul></div><a href="https://github.com/apache/incubator-linkis" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg t="1631348384596" class="iconLanguage_EbrZ" viewBox="0 0 1024 1024" version="1.1" p-id="557" width="20" height="20"><path d="M547.797333 638.208l-104.405333-103.168 1.237333-1.28a720.170667 720.170667 0 0 0 152.490667-268.373333h120.448V183.082667h-287.744V100.906667H347.605333v82.218666H59.818667V265.386667h459.178666a648.234667 648.234667 0 0 1-130.304 219.946666 643.242667 643.242667 0 0 1-94.976-137.728H211.541333a722.048 722.048 0 0 0 122.453334 187.434667l-209.194667 206.378667 58.368 58.368 205.525333-205.525334 127.872 127.829334 31.232-83.84m231.424-208.426667h-82.218666l-184.96 493.312h82.218666l46.037334-123.306667h195.242666l46.464 123.306667h82.218667l-185.002667-493.312m-107.690666 287.744l66.56-178.005333 66.602666 178.005333z" fill="currentColor" p-id="558"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/blog" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">English</a></li><li><a href="/zh-CN/blog" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">简体中文</a></li></ul></div><div class="searchBox_Bc3W"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-list-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">Recent posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/10/09/linkis-service-merge">Apache Linkis 1.3.0 PES(Public Enhancement Services) Some Service Merge</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/09/27/linkis111-deploy">Deploy Apache Linkis1.1.1 and DSS1.1.0 based on CDH6.3.2</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/08/08/linkis111-compile-integration">Linkis1.1.1 adapts Hadoop 3.1.1 and deploys other services</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/07/16/deploy-linkis-with-kubernetes">Deploy Linkis with Kubernetes</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/07/04/how-to-add-auto-bot">How to add a GitHub Action for the GitHub repository</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/06/09/meetup-content-review">Apache Linkis(Incubating) Meet up</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/04/15/how-to-download-engineconn-plugin">How to Download Engine Plugins Not Included in the Installation Package By Default</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/03/20/openlookeng">Implementation of OpenLookEng Engine</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/02/21/linkis-deploy">Linkis Deployment Troubleshooting</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/02/08/how-to-user-blog">How to Write a Blog</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/blog/2022/10/09/linkis-service-merge">Apache Linkis 1.3.0 PES(Public Enhancement Services) Some Service Merge</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-10-09T00:00:00.000Z" itemprop="datePublished">October 9, 2022</time> · 6 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/aiceflower/" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://avatars.githubusercontent.com/u/22620332?s=400&amp;v=4" alt="aiceflower"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/aiceflower/" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">aiceflower</span></a></div><small class="avatar__subtitle" itemprop="description">Development Engineer of WeBank</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="foreword"></a>Foreword<a class="hash-link" href="#foreword" title="Direct link to heading">#</a></h3><p>With the development of business and the update and iteration of community products, we found that Linkis1 There are too many .X services, and services can be merged appropriately to reduce the number of services and facilitate deployment and debugging. At present, Linkis services are mainly divided into three categories, including computing governance services (CG: entrance/ecp/ecm/linkismanager), public enhancement services (PS: publicservice/datasource/cs) and microservice governance services (MG: Gateway/Eureka) . There are too many sub-services extended by these three types of services, and services can be merged, so that all PS services can be merged, CG services can be merged, and ecm services can be separated out. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="service-merge-changes"></a>Service merge changes<a class="hash-link" href="#service-merge-changes" title="Direct link to heading">#</a></h3><p>The main changes of this service merge are as follows: </p><ul><li>Support Restful service forwarding: The modification point is mainly the forwarding logic of Gateway, similar to the current publicservice service merge parameter: wds.linkis.gateway.conf.publicservice.list </li><li>Support Change the remote call of the RPC service to a local call, similar to LocalMessageSender, and now it is possible to complete the return of the local call by changing the Sender </li><li>Configuration file changes </li><li>Service start and stop script changes </li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="to-be-achieved"></a>To be achieved<a class="hash-link" href="#to-be-achieved" title="Direct link to heading">#</a></h3><ul><li>Basic goal: merge PS services into one service </li><li>Basic goal: merge CG service into CG-Service and ECM</li><li>Advanced goal: merge CG services into one server </li><li>Final goal: remove eureka, gateway into single service </li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="specific-changes"></a>Specific changes<a class="hash-link" href="#specific-changes" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="gateway-changes-orgapachelinkisgatewayujesroutehacontextgatewayrouter"></a>Gateway changes (org.apache.linkis.gateway.ujes.route.HaContextGatewayRouter)<a class="hash-link" href="#gateway-changes-orgapachelinkisgatewayujesroutehacontextgatewayrouter" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">//Override before changing </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">def route(gatewayContext: GatewayContext): ServiceInstance = { </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (gatewayContext.getGatewayRoute.getRequestURI.contains(HaContextGatewayRouter.CONTEXT_SERVICE_STR) || </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        gatewayContext.getGatewayRoute.getRequestURI.contains(HaContextGatewayRouter.OLD_CONTEXT_SERVICE_PREFIX)){ </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      val params: util.HashMap[String, String] = gatewayContext.getGatewayRoute.getParams </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      if (!gatewayContext.getRequest.getQueryParams.isEmpty) { </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        for ((k, vArr) &lt;- gatewayContext.getRequest.getQueryParams) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          if (vArr.nonEmpty) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            params.putIfAbsent(k, vArr.head)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      if (gatewayContext.getRequest.getHeaders.containsKey(ContextHTTPConstant.CONTEXT_ID_STR)) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        params.putIfAbsent(ContextHTTPConstant.CONTEXT_ID_STR, gatewayContext.getRequest.getHeaders.get(ContextHTTPConstant.CONTEXT_ID_STR)(0))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      if (null == params || params.isEmpty) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        dealContextCreate(gatewayContext)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      } else {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        var contextId : String = null</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        for ((key, value) &lt;- params) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          if (key.equalsIgnoreCase(ContextHTTPConstant.CONTEXT_ID_STR)) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            contextId = value</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (StringUtils.isNotBlank(contextId)) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          dealContextAccess(contextId.toString, gatewayContext)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        } else {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          dealContextCreate(gatewayContext)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }else{</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      null</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  //after modification</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  override def route(gatewayContext: GatewayContext): ServiceInstance = {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        gatewayContext.getGatewayRoute.getRequestURI.contains(</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          RPCConfiguration.CONTEXT_SERVICE_REQUEST_PREFIX</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        )</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      val params: util.HashMap[String, String] = gatewayContext.getGatewayRoute.getParams</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      if (!gatewayContext.getRequest.getQueryParams.isEmpty) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        for ((k, vArr) &lt;- gatewayContext.getRequest.getQueryParams.asScala) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          if (vArr.nonEmpty) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            params.putIfAbsent(k, vArr.head)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      if (gatewayContext.getRequest.getHeaders.containsKey(ContextHTTPConstant.CONTEXT_ID_STR)) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        params.putIfAbsent(</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          ContextHTTPConstant.CONTEXT_ID_STR,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          gatewayContext.getRequest.getHeaders.get(ContextHTTPConstant.CONTEXT_ID_STR)(0)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        )</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      if (null == params || params.isEmpty) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        dealContextCreate(gatewayContext)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      } else {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        var contextId: String = null</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        for ((key, value) &lt;- params.asScala) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          if (key.equalsIgnoreCase(ContextHTTPConstant.CONTEXT_ID_STR)) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            contextId = value</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (StringUtils.isNotBlank(contextId)) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          dealContextAccess(contextId, gatewayContext)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        } else {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          dealContextCreate(gatewayContext)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    } else {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      null</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // before modification</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  def dealContextCreate(gatewayContext:GatewayContext):ServiceInstance = {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    val serviceId =  findService(HaContextGatewayRouter.CONTEXT_SERVICE_STR, list =&gt; {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      val services = list.filter(_.contains(HaContextGatewayRouter.CONTEXT_SERVICE_STR))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      services.headOption</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    })</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    val serviceInstances = ServiceInstanceUtils.getRPCServerLoader.getServiceInstances(serviceId.orNull)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (serviceInstances.size &gt; 0) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      val index = new Random().nextInt(serviceInstances.size)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      serviceInstances(index)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    } else {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      logger.error(s&quot;No valid instance for service : &quot; + serviceId.orNull)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      null</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  //after modification</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  def dealContextCreate(gatewayContext: GatewayContext): ServiceInstance = {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    val serviceId = findService(</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      RPCConfiguration.CONTEXT_SERVICE_NAME,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      list =&gt; {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        val services = list.filter(_.contains(RPCConfiguration.CONTEXT_SERVICE_NAME))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        services.headOption</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    )</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    val serviceInstances =</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      ServiceInstanceUtils.getRPCServerLoader.getServiceInstances(serviceId.orNull)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (serviceInstances.size &gt; 0) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      val index = new Random().nextInt(serviceInstances.size)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      serviceInstances(index)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    } else {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      logger.error(s&quot;No valid instance for service : &quot; + serviceId.orNull)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      null</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // before modification</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  def dealContextAccess(contextIdStr:String, gatewayContext: GatewayContext):ServiceInstance = {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    val contextId : String = {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      var tmpId : String = null</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      if (serializationHelper.accepts(contextIdStr)) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        val contextID : ContextID = serializationHelper.deserialize(contextIdStr).asInstanceOf[ContextID]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (null != contextID) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          tmpId = contextID.getContextId</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        } else {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          logger.error(s&quot;Deserializate contextID null. contextIDStr : &quot; + contextIdStr)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      } else {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        logger.error(s&quot;ContxtIDStr cannot be deserialized. contextIDStr : &quot; + contextIdStr)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      if (null == tmpId) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        contextIdStr</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      } else {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        tmpId</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    val instances = contextIDParser.parse(contextId)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    var serviceId:Option[String] = None</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    serviceId = findService(HaContextGatewayRouter.CONTEXT_SERVICE_STR, list =&gt; {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      val services = list.filter(_.contains(HaContextGatewayRouter.CONTEXT_SERVICE_STR))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        services.headOption</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      })</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    val serviceInstances = ServiceInstanceUtils.getRPCServerLoader.getServiceInstances(serviceId.orNull)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (instances.size() &gt; 0) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      serviceId.map(ServiceInstance(_, instances.get(0))).orNull</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    } else if (serviceInstances.size &gt; 0) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      serviceInstances(0)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    } else {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      logger.error(s&quot;No valid instance for service : &quot; + serviceId.orNull)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      null</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//after modification</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">def dealContextAccess(contextIdStr: String, gatewayContext: GatewayContext): ServiceInstance = {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    val contextId: String = {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      var tmpId: String = null</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      if (serializationHelper.accepts(contextIdStr)) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        val contextID: ContextID =</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          serializationHelper.deserialize(contextIdStr).asInstanceOf[ContextID]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (null != contextID) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          tmpId = contextID.getContextId</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        } else {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          logger.error(s&quot;Deserializate contextID null. contextIDStr : &quot; + contextIdStr)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      } else {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        logger.error(s&quot;ContxtIDStr cannot be deserialized. contextIDStr : &quot; + contextIdStr)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      if (null == tmpId) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        contextIdStr</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      } else {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        tmpId</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    val instances = contextIDParser.parse(contextId)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    var serviceId: Option[String] = None</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    serviceId = findService(</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      RPCConfiguration.CONTEXT_SERVICE_NAME,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      list =&gt; {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        val services = list.filter(_.contains(RPCConfiguration.CONTEXT_SERVICE_NAME))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        services.headOption</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    )</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    val serviceInstances =</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      ServiceInstanceUtils.getRPCServerLoader.getServiceInstances(serviceId.orNull)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (instances.size() &gt; 0) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      serviceId.map(ServiceInstance(_, instances.get(0))).orNull</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    } else if (serviceInstances.size &gt; 0) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      serviceInstances(0)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    } else {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      logger.error(s&quot;No valid instance for service : &quot; + serviceId.orNull)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      null</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// before modification</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">object HaContextGatewayRouter{</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  val CONTEXT_ID_STR:String = &quot;contextId&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  val CONTEXT_SERVICE_STR:String = &quot;ps-cs&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @Deprecated</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  val OLD_CONTEXT_SERVICE_PREFIX = &quot;contextservice&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  val CONTEXT_REGEX: Regex = (normalPath(API_URL_PREFIX) + &quot;rest_[a-zA-Z][a-zA-Z_0-9]*/(v\\d+)/contextservice/&quot; + &quot;.+&quot;).r</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//after modification</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">object HaContextGatewayRouter {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  val CONTEXT_ID_STR: String = &quot;contextId&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @deprecated(&quot;please use RPCConfiguration.CONTEXT_SERVICE_REQUEST_PREFIX&quot;)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  val CONTEXT_SERVICE_REQUEST_PREFIX = RPCConfiguration.CONTEXT_SERVICE_REQUEST_PREFIX</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @deprecated(&quot;please use RPCConfiguration.CONTEXT_SERVICE_NAME&quot;)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  val CONTEXT_SERVICE_NAME: String =</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        RPCConfiguration.ENABLE_PUBLIC_SERVICE.getValue &amp;&amp; RPCConfiguration.PUBLIC_SERVICE_LIST</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          .exists(_.equalsIgnoreCase(RPCConfiguration.CONTEXT_SERVICE_REQUEST_PREFIX))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      RPCConfiguration.PUBLIC_SERVICE_APPLICATION_NAME.getValue</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    } else {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      RPCConfiguration.CONTEXT_SERVICE_APPLICATION_NAME.getValue</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  val CONTEXT_REGEX: Regex =</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (normalPath(API_URL_PREFIX) + &quot;rest_[a-zA-Z][a-zA-Z_0-9]*/(v\\d+)/contextservice/&quot; + &quot;.+&quot;).r</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="rpc-service-changeorgapachelinkisrpcconfrpcconfiguration"></a>RPC Service Change（org.apache.linkis.rpc.conf.RPCConfiguration）<a class="hash-link" href="#rpc-service-changeorgapachelinkisrpcconfrpcconfiguration" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">//before modification</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">val BDP_RPC_BROADCAST_THREAD_SIZE: CommonVars[Integer] = CommonVars(&quot;wds.linkis.rpc.broadcast.thread.num&quot;, new Integer(25))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//after modification</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">val BDP_RPC_BROADCAST_THREAD_SIZE: CommonVars[Integer] = CommonVars(&quot;wds.linkis.rpc.broadcast.thread.num&quot;, 25)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//before modification</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">val PUBLIC_SERVICE_LIST: Array[String] = CommonVars(&quot;wds.linkis.gateway.conf.publicservice.list&quot;, &quot;query,jobhistory,application,configuration,filesystem,udf,variable,microservice,errorcode,bml,datasource&quot;).getValue .split(&quot;,&quot;) </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">//after change </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">val PUBLIC_SERVICE_LIST: Array[String] = CommonVars(&quot;wds.linkis.gateway.conf.publicservice.list&quot;, &quot;cs,contextservice,data-source-manager,metadataquery,metadatamanager, query,jobhistory,application,configuration,filesystem,udf,variable,microservice,errorcode,bml,datasource&quot;).getValue.split(&quot;,&quot;) </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="configuration-file-changes"></a>Configuration file changes<a class="hash-link" href="#configuration-file-changes" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">##Remove part #Delete the </span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">following configuration files </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">linkis</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">dist/package/conf/linkis</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">ps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">cs.properties </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">linkis</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">dist/package/conf/linkis</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">ps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">source</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">manager.properties</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">linkis</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">dist/package/conf/linkis</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">ps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">metadataquery.properties</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">##modified part</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#modify linkis-dist/package/conf/linkis-ps-publicservice.properties</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#restful before modification</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.server.restful.scan.packages=org.apache.linkis.jobhistory.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.variable.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.configuration.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.udf.api</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.filesystem.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.filesystem.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.instance.label.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.metadata.restful.api</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.cs.server.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.bml.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.errorcode.server.restful</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#restful after modification</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.server.restful.scan.packages=org.apache.linkis.cs.server.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.datasourcemanager.core.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.metadata.query.server.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.jobhistory.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.variable.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.configuration.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.udf.api</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.filesystem.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.filesystem.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.instance.label.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.metadata.restful.api</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.cs.server.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.bml.restful</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.errorcode.server.restful</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#mybatis before modification</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.server.mybatis.mapperLocations=classpath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">org/apache/linkis/jobhistory/dao/impl/</span><span class="token important">*.xml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">classpath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">org/apache/linkis/variable/dao/impl/</span><span class="token important">*.xml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">classpath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">org/apache/linkis/configuration/dao/impl/</span><span class="token important">*.xml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">classpath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">org/apache/linkis/udf/dao/impl/</span><span class="token important">*.xml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">classpath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">org/apache/linkis/instance/label/dao/impl/</span><span class="token important">*.xml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">classpath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">org/apache/linkis/metadata/hive/dao/impl/</span><span class="token important">*.xml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org/apache/linkis/metadata/dao/impl/</span><span class="token important">*.xml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">classpath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">org/apache/linkis/bml/dao/impl/</span><span class="token important">*.xml</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.server.mybatis.typeAliasesPackage=org.apache.linkis.configuration.entity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.jobhistory.entity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.udf.entity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.variable.entity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.instance.label.entity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.manager.entity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.metadata.domain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.bml.entity</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.server.mybatis.BasePackage=org.apache.linkis.jobhistory.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.variable.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.configuration.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.udf.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.instance.label.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.metadata.hive.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.metadata.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.bml.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.errorcode.server.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.publicservice.common.lock.dao</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#mybatis after modification</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.server.mybatis.mapperLocations=classpath</span><span class="token important">*:org/apache/linkis/cs/persistence/dao/impl/*.xml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">classpath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">org/apache/linkis/datasourcemanager/core/dao/mapper/</span><span class="token important">*.xml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">classpath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">org/apache/linkis/jobhistory/dao/impl/</span><span class="token important">*.xml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">classpath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">org/apache/linkis/variable/dao/impl/</span><span class="token important">*.xml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">classpath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">org/apache/linkis/configuration/dao/impl/</span><span class="token important">*.xml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">classpath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">org/apache/linkis/udf/dao/impl/</span><span class="token important">*.xml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">classpath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">org/apache/linkis/instance/label/dao/impl/</span><span class="token important">*.xml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">classpath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">org/apache/linkis/metadata/hive/dao/impl/</span><span class="token important">*.xml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org/apache/linkis/metadata/dao/impl/</span><span class="token important">*.xml</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">classpath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">org/apache/linkis/bml/dao/impl/</span><span class="token important">*.xml</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.server.mybatis.typeAliasesPackage=org.apache.linkis.cs.persistence.entity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.datasourcemanager.common.domain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.datasourcemanager.core.vo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.configuration.entity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.jobhistory.entity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.udf.entity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.variable.entity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.instance.label.entity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.manager.entity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.metadata.domain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.bml.entity</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.server.mybatis.BasePackage=org.apache.linkis.cs.persistence.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.datasourcemanager.core.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.jobhistory.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis. variable.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.configuration.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.udf.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.instance.label.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.metadata.hive.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org. apache.linkis.metadata.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.bml.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.errorcode.server.dao</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">org.apache.linkis.publicservice.common.lock.dao </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="deployment-script-changes-linkis-distpackagesbinlinkis-start-allsh"></a>Deployment script changes (linkis-dist/package/sbin/linkis-start-all.sh)<a class="hash-link" href="#deployment-script-changes-linkis-distpackagesbinlinkis-start-allsh" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">startup script remove the following part </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#linkis-ps-cs </span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVER_NAME</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ps-cs&quot;</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVER_IP</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$CS_INSTALL_IP</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">startApp </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$ENABLE_METADATA_QUERY</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;true&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">#linkis-ps-data-source-manager</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVER_NAME</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ps-data-source-manager&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVER_IP</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$DATASOURCE_MANAGER_INSTALL_IP</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  startApp</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">#linkis-ps-metadataquery</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVER_NAME</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ps-metadataquery&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVER_IP</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$METADATA_QUERY_INSTALL_IP</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  startApp</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#linkis-ps-cs</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVER_NAME</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ps-cs&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVER_IP</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$CS_INSTALL_IP</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">checkServer</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$ENABLE_METADATA_QUERY</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;true&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">#linkis-ps-data-source-manager</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVER_NAME</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ps-data-source-manager&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVER_IP</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$DATASOURCE_MANAGER_INSTALL_IP</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  checkServer</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">#linkis-ps-metadataquery</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVER_NAME</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ps-metadataquery&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVER_IP</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$METADATA_QUERY_INSTALL_IP</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  checkServer</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#Service stop script remove the following part </span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#linkis-ps-cs </span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVER_NAME</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ps-cs&quot;</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVER_IP</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$CS_INSTALL_IP</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">stopApp </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$ENABLE_METADATA_QUERY</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;true&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">#linkis-ps-data-source-manager </span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  SERVER_NAME </span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ps-data-source-manager&quot;</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVER_IP</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$DATASOURCE_MANAGER_INSTALL_IP</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  stopApp </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">#linkis-ps-metadataquery </span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVER_NAME</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ps-metadataquery&quot;</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVER_IP</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$METADATA_QUERY_INSTALL_IP</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  stopApp </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>For more details on service merge changes, see: https://github .com/apache/incubator-linkis/pull/2927/files</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/blog">blog</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/linki-1-3-0">linki1.3.0</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/service-merge">service merge</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/blog/2022/09/27/linkis111-deploy">Deploy Apache Linkis1.1.1 and DSS1.1.0 based on CDH6.3.2</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-09-27T00:00:00.000Z" itemprop="datePublished">September 27, 2022</time> · 5 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/kongslove" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://avatars.githubusercontent.com/u/42604208?v=4" alt="kevinWdong"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/kongslove" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">kevinWdong</span></a></div><small class="avatar__subtitle" itemprop="description">contributors</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>With the development of business and the update and iteration of community products, we found that Linkis1. X has greatly improved its performance in terms of resource management and engine management, which can better meet the requirements of the construction of data middle stations. Compared with version 0.9.3 and the platform we used before, the user experience has also been greatly improved, and the problems such as the inability to view details on the task failure page have also been improved. Therefore, we decided to upgrade Linkis and the WDS suite. The following are the specific practical operations, which we hope will give you a reference.</p><header><h1>1.Environment</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="cdh632-component-versions"></a>CDH6.3.2 Component versions<a class="hash-link" href="#cdh632-component-versions" title="Direct link to heading">#</a></h2><ul><li>hadoop:3.0.0-cdh6.3.2</li><li>hive:2.1.1-cdh6.3.2</li><li>spark：2.4.8</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="hardware-environment"></a>hardware environment <a class="hash-link" href="#hardware-environment" title="Direct link to heading">#</a></h2><p>128G cloud physical machine*2</p><header><h1>2. Linkis installation and deployment</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="21-compile-code-or-release-installation-package"></a>2.1 Compile code or release installation package?<a class="hash-link" href="#21-compile-code-or-release-installation-package" title="Direct link to heading">#</a></h2><p>This installation deployment adopts the release installation package method. In order to adapt to the company&#x27;s CDH6.3.2 version, the dependency packages of hadoop and hive need to be replaced with the CDH6.3.2 version. Here, the installation package is directly replaced. The dependent packages and modules to be replaced are shown in the following list.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plain"><pre tabindex="0" class="prism-code language-plain codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Modules involved </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">linkis-engineconn-plugins/spark</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">linkis-engineconn-plugins/hive</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/linkis-commons/public-module</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/linkis-computation-governance/</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plain"><pre tabindex="0" class="prism-code language-plain codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// List of cdh packages that need to be replaced</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/spark/dist/v2.4.8/lib/hive-shims-0.23-2.1.1-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/spark/dist/v2.4.8/lib/hive-shims-scheduler-2.1.1-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/spark/dist/v2.4.8/lib/hadoop-annotations-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/spark/dist/v2.4.8/lib/hadoop-auth-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/spark/dist/v2.4.8/lib/hadoop-common-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/spark/dist/v2.4.8/lib/hadoop-hdfs-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/spark/dist/v2.4.8/lib/hadoop-hdfs-client-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/hive/dist/v2.1.1/lib/hadoop-client-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/hive/dist/v2.1.1/lib/hadoop-mapreduce-client-common-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/hive/dist/v2.1.1/lib/hadoop-mapreduce-client-jobclient-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/hive/dist/v2.1.1/lib/hadoop-yarn-api-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/hive/dist/v2.1.1/lib/hadoop-yarn-client-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/hive/dist/v2.1.1/lib/hadoop-yarn-server-common-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/hive/dist/v2.1.1/lib/hadoop-hdfs-client-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/hive/dist/v2.1.1/lib/hadoop-mapreduce-client-core-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/hive/dist/v2.1.1/lib/hadoop-mapreduce-client-shuffle-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/hive/dist/v2.1.1/lib/hadoop-yarn-common-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/flink/dist/v1.12.2/lib/hadoop-annotations-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/flink/dist/v1.12.2/lib/hadoop-auth-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/flink/dist/v1.12.2/lib/hadoop-mapreduce-client-core-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/flink/dist/v1.12.2/lib/hadoop-yarn-api-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/flink/dist/v1.12.2/lib/hadoop-yarn-client-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-engineconn-plugins/flink/dist/v1.12.2/lib/hadoop-yarn-common-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-commons/public-module/hadoop-annotations-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-commons/public-module/hadoop-auth-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-commons/public-module/hadoop-common-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-commons/public-module/hadoop-hdfs-client-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-computation-governance/linkis-cg-linkismanager/hadoop-annotations-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-computation-governance/linkis-cg-linkismanager/hadoop-auth-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-computation-governance/linkis-cg-linkismanager/hadoop-yarn-api-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-computation-governance/linkis-cg-linkismanager/hadoop-yarn-client-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./lib/linkis-computation-governance/linkis-cg-linkismanager/hadoop-yarn-common-3.0.0-cdh6.3.2.jar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="22-problems-encountered-during-deployment"></a>2.2 Problems encountered during deployment<a class="hash-link" href="#22-problems-encountered-during-deployment" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="221--kerberos-configuration"></a>2.2.1  Kerberos configuration<a class="hash-link" href="#221--kerberos-configuration" title="Direct link to heading">#</a></h3><p>It needs to be added in the linkis.properties public configuration</p><p>Each engine conf also needs to be added</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plain"><pre tabindex="0" class="prism-code language-plain codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.keytab.enable=true</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.keytab.file=/hadoop/bigdata/kerberos/keytab</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.keytab.host.enabled=false</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.keytab.host=your_host</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="222--error-is-reported-after-hadoop-dependency-package-is-replaced"></a>2.2.2  Error is reported after Hadoop dependency package is replaced<a class="hash-link" href="#222--error-is-reported-after-hadoop-dependency-package-is-replaced" title="Direct link to heading">#</a></h3><p>java.lang.NoClassDefFoundError:org/apache/commons/configuration2/Configuration</p><p><img alt="image" src="/assets/images/config-err-0b7267a47e539866aefbe8be9db6c197.png"></p><p>Cause: Configuration class conflict. Add a commons-configuration2-2.1.1.jar under the linkis commons module to resolve the conflict</p><h3></h3><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="223-running-spark-python-etc-in-script-reports-no-plugin-for-xxx"></a>2.2.3 Running spark, python, etc. in script reports no plugin for XXX<a class="hash-link" href="#223-running-spark-python-etc-in-script-reports-no-plugin-for-xxx" title="Direct link to heading">#</a></h3><p>Phenomenon: After modifying the version of Spark/Python in the configuration file, the startup engine reports no plugin for XXX</p><p><img alt="image" src="/assets/images/pugin-error-0b7267a47e539866aefbe8be9db6c197.png"></p><p>Reason: LabelCommonConfig.java and GovernanceCommonConf In scala, the version of the engine is written dead, the corresponding version is modified, and all jars containing these two classes (linkis computation governance common-1.1.1. jar and linkis label common-1.1.1. jar) in linkis and other components (including scheduleris) are replaced after compilation</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="224-python-engine-execution-error-initialization-failed"></a>2.2.4 Python engine execution error, initialization failed<a class="hash-link" href="#224-python-engine-execution-error-initialization-failed" title="Direct link to heading">#</a></h3><ul><li>Modify python. py and remove the imported pandas module</li><li>Configure the python loading directory and modify the python engine&#x27;s linkis-enginecon.properties</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI plain"><pre tabindex="0" class="prism-code language-plain codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pythonVersion=/usr/local/bin/python3.6</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="225-failed-to-run-the-pyspark-task-and-reported-an-error"></a>2.2.5 Failed to run the pyspark task and reported an error<a class="hash-link" href="#225-failed-to-run-the-pyspark-task-and-reported-an-error" title="Direct link to heading">#</a></h3><p><img alt="image" src="/assets/images/pyspark-error-59e263d21e848c5bda995cdc900e0ca9.png"></p><p>Reason: PYSPARK is not set_ VERSION</p><p>resolvent:</p><p>Set two parameters in/etc/profile</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">export PYSPARK_ PYTHON=/usr/local/bin/python3.6</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">export PYSPARK_ DRIVER_PYTHON=/usr/local/bin/python3.6</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="226-error-occurs-when-executing-the-pyspark-task"></a>2.2.6 Error occurs when executing the pyspark task<a class="hash-link" href="#226-error-occurs-when-executing-the-pyspark-task" title="Direct link to heading">#</a></h3><p>java.lang.NoSuchFieldError: HIVE<em> STATS</em> JDBC_ TIMEOUT</p><p><img alt="image" src="/assets/images/spark-hive-verion-error-73f07dc42df540b1aeb4ea048a131fa8.png"></p><p>Reason: Spark 2.4.8 uses the hive1.2.1 package, but our hive has been upgraded to version 2.1.1. This parameter has been removed from hive2. Then the code in spark sql still calls the hive parameter, and then an error is reported,</p><p>Therefore, HIVE is deleted from the spark sql/hive code<em> STATS</em> JDBC<em> TIMEOUT This parameter is recompiled and packaged to replace the spark hive in spark 2.4.8</em> 2.11-2.4.8.jar</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="227-proxy-user-exception-during-jdbc-engine-execution"></a>2.2.7 Proxy user exception during jdbc engine execution<a class="hash-link" href="#227-proxy-user-exception-during-jdbc-engine-execution" title="Direct link to heading">#</a></h3><p>Phenomenon: User A is used to execute a jdbc task 1. The engine chooses to reuse it. Then I also use User B to execute a jdbc task 2. It is found that the submitter of task 2 is A</p><p>Analysis reason:</p><p>ConnectionManager::getConnection</p><p><img alt="image" src="/assets/images/jdbc-engine-analyze-e765a7057a729bb49816e9e7ebffc787.png"></p><p>When creating a datasource, we judge whether to create it according to the key. The key is a jdbc url, but this granularity may be a bit large, because different users may access the same datasource, such as hive. Their urls are the same, but their account passwords are different. So when the first user creates a datasource, the username has been specified. When the second user comes in, If the data source is found to exist, it will be used directly instead of creating a new data source. Therefore, the code submitted by user B will be executed by user A.</p><p>Solution: Reduce the key granularity of the data source cache map, and change it to jdbc. url+jdbc. user.</p><ol start="3"><li>DSS deployment
The installation process refers to the official website documents for installation configuration. The following describes some issues encountered in the installation and debugging process.</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="31-the-database-list-displayed-on-the-left-side-of-the-dss-is-incomplete"></a>3.1 The database list displayed on the left side of the DSS is incomplete<a class="hash-link" href="#31-the-database-list-displayed-on-the-left-side-of-the-dss-is-incomplete" title="Direct link to heading">#</a></h2><p>Analysis: The database information displayed in the DSS data source module is from the hive metabase. However, because of the permission control through the Sentry in CDH6, most of the hive table metadata information does not exist in the hive metastore, so the displayed data is missing.</p><p>resolvent:</p><p>The original logic is transformed into the way of using jdbc to link hive and obtain table data display from jdbc.</p><p>Simple logic description:</p><p>The properties information of jdbc is obtained through the IDE jdbc configuration information configured on the linkis console.</p><p>DBS: Get the schema through connection. getMetaData()</p><p>TBS: connection. getMetaData(). getTables() Get the tables under the corresponding db</p><p>COLUMNS: Get the columns information of the table by executing describe table</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="32-error-jdbc-is-reported-when-executing-jdbc-script-in-dss-workflow-name-is-empty"></a>3.2 Error jdbc is reported when executing jdbc script in DSS workflow name is empty<a class="hash-link" href="#32-error-jdbc-is-reported-when-executing-jdbc-script-in-dss-workflow-name-is-empty" title="Direct link to heading">#</a></h2><p>Analysis: The default creator in the dss workflow is Schedulis. Because the related engine parameters of Schedulis are not configured in the management console, the parameters read are all empty.</p><p>Adding a category of Schedulis to the console gives an error, ”The Schedulis directory already exists. Because the creator in the scheduling system is schedulis, the Schedulis Category cannot be added. In order to better identify each system, the default creator in the dss workflow is changed to nod_exception. This parameter can add wds. linkis. flow. job. creator. v1=nod_execution in the dss flow execution server. properties.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/blog">blog</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/linki-1-1-1">linki1.1.1</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/hadoop-3-0-0-cdh-6-3-2">hadoop3.0.0-cdh6.3.2</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/spark-2-4-8">spark2.4.8</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/hive-2-1-1">hive2.1.1</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/blog/2022/08/08/linkis111-compile-integration">Linkis1.1.1 adapts Hadoop 3.1.1 and deploys other services</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-08-08T00:00:00.000Z" itemprop="datePublished">August 8, 2022</time> · 14 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/ruY9527" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://avatars.githubusercontent.com/u/43773582?v=4" alt="ruY9527"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/ruY9527" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">ruY9527</span></a></div><small class="avatar__subtitle" itemprop="description">contributors</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="environment-and-version"></a>Environment and Version<a class="hash-link" href="#environment-and-version" title="Direct link to heading">#</a></h2><ul><li>jdk-8 , maven-3.6.3</li><li>node-14.15.0(Compiling the front end requires)</li><li>Gradle-4.6(Compile qualitis quality service)</li><li>hadoop-3.1.1,Spark-3.0.1,Hive-3.1.2,Flink-1.13.2,Sqoop-1.4.7 (Apache version)</li><li>linkis-1.1.1</li><li>DataSphereStudio-1.1.0</li><li>Schudulis-0.7.0</li><li>Qualitis-0.9.2</li><li>Visualis-1.0.0</li><li>Streamis-0.2.0</li><li>Exchangis-1.0.0</li><li>Chrome recommends versions below 100</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="scenarios-and-versions-of-each-component"></a>Scenarios and versions of each component<a class="hash-link" href="#scenarios-and-versions-of-each-component" title="Direct link to heading">#</a></h2><table><thead><tr><th>System name</th><th>Version</th><th>scene</th></tr></thead><tbody><tr><td>linkis</td><td>1.1.1</td><td>Engine orchestration, running and executing hive, spark, flinksql, shell, python, etc., unified data source management, etc</td></tr><tr><td>DataSphereStudio</td><td>1.1.0</td><td>Implement DAG scheduling of tasks, integrate the specifications of other systems and provide unified access, and provide sparksql based service API</td></tr><tr><td>Schudulis</td><td>0.7.0</td><td>Task scheduling, as well as scheduling details and rerouting, and provide trap data based on the selected time</td></tr><tr><td>Qualitis</td><td>0.9.2</td><td>Provide built-in SQL version and other functions, check common data quality and customizable SQL, verify some data that does not conform to the rules, and write it to the corresponding library</td></tr><tr><td>Exchangis</td><td>1.0.0</td><td>Hive to MySQL, data exchange between MySQL and hive</td></tr><tr><td>Streamis</td><td>0.2.0</td><td>Streaming development and Application Center</td></tr><tr><td>Visualis</td><td>1.0.0</td><td>Visual report display, can share external links</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="deployment-sequence"></a>Deployment sequence<a class="hash-link" href="#deployment-sequence" title="Direct link to heading">#</a></h2><p>  You can select and adjust the sequence after serial number 3 However, one thing to pay attention to when deploying exchangis is to copy the sqoop engine plug-in of exchangis to the engine plug-in package under lib of linkis
Schedulis, qualitis, exchangis, streamis, visualis and other systems are integrated with DSS through their respective appconn. Note that after integrating the component appconn, restart the service module corresponding to DSS or restart DSS</p><ol><li>linkis</li><li>DataSphereStudio</li><li>Schedulis</li><li>Qualitis</li><li>Exchangis</li><li>Streamis</li><li>Visualis</li></ol><p><img alt="image.png" src="/assets/images/sx1-808e41fd5ce8b7cdf2a72953efcfb52a.png"></p><p>If you integrate skywalking, you can see the service status and connection status in the extended topology diagram, as shown in the following figure:
<img alt="image.png" src="/assets/images/sx2-72292e18cadcfa92b920613ea29abb73.png">
At the same time, you can also clearly see the call link in the trace, as shown in the following figure, which is also convenient for you to locate the error log file of the specific service
<img alt="image.png" src="/assets/images/sx3-967b6ac9e375892ec45cfc8fe8e1a46c.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="dependency-adjustment-and-packaging"></a>Dependency adjustment and packaging<a class="hash-link" href="#dependency-adjustment-and-packaging" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="linkis"></a>linkis<a class="hash-link" href="#linkis" title="Direct link to heading">#</a></h3><p>Since spark uses version 3. X, Scala also needs to be upgraded to version 12
<a href="https://github.com/apache/incubator-linkis/tree/release-1.1.1" target="_blank" rel="noopener noreferrer">Original project code address</a>
<a href="https://github.com/ruY9527/incubator-linkis/tree/release-1.1.1-hadoop3.x" target="_blank" rel="noopener noreferrer">Adaptation modification code reference address</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="the-pom-file-of-linkis"></a>The pom file of linkis<a class="hash-link" href="#the-pom-file-of-linkis" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">hadoop.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">3.1.1</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">hadoop.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">scala.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">2.12.10</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">scala.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">scala.binary.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">2.12</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">scala.binary.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!-- hadoop-hdfs replace with hadoop-hdfs-client --&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">org.apache.hadoop</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">hadoop-hdfs-client</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">${hadoop.version}</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="the-pom-file-of-linkis-hadoop-common"></a>The pom file of linkis-hadoop-common<a class="hash-link" href="#the-pom-file-of-linkis-hadoop-common" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!-- Notice here &lt;version&gt;${hadoop.version}&lt;/version&gt; , adjust according to whether you have encountered any errors --&gt;</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">org.apache.hadoop</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">hadoop-hdfs-client</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">${hadoop.version}</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="the-pom-file-of-linkis-engineplugin-hive"></a>The pom file of linkis-engineplugin-hive<a class="hash-link" href="#the-pom-file-of-linkis-engineplugin-hive" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">hive.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">3.1.2</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">hive.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="the-pom-file-of-linkis-engineplugin-spark"></a>The pom file of linkis-engineplugin-spark<a class="hash-link" href="#the-pom-file-of-linkis-engineplugin-spark" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">spark.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">3.0.1</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">spark.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The getfield method in sparkscalaexecutor needs to adjust the following code</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">protected def getField(obj: Object, name: String): Object = {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // val field = obj.getClass.getField(name)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    val field = obj.getClass.getDeclaredField(&quot;in0&quot;)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        field.setAccessible(true)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        field.get(obj)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="the-pom-file-of-linkis-engineplugin-flink"></a>The pom file of linkis-engineplugin-flink<a class="hash-link" href="#the-pom-file-of-linkis-engineplugin-flink" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">flink.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">1.13.2</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">flink.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Due to the adjustment of some classes in Flink 1.12.2 and 1.13.2, we refer to the temporary &quot;violence&quot; method given by the community students: copy the classes in part 1.12.2 to 1.13.2, adjust the scala version to 12, and compile them by ourselves
It involves the specific modules of flink: flink-sql-client_${scala.binary.version}</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">-- Note that the following classes are copied from 1.12.2 to 1.13.2</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">org.apache.flink.table.client.config.entries.DeploymentEntry</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">org.apache.flink.table.client.config.entries.ExecutionEntry</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">org.apache.flink.table.client.gateway.local.CollectBatchTableSink</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">org.apache.flink.table.client.gateway.local.CollectStreamTableSink</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><img alt="image.png" src="/assets/images/flink1-087dcf93f3692dc19b9eff3ba204823d.png"><img alt="image.png" src="/assets/images/flink2-fa8164c77b9feccfd6381b816995fcdd.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="linkis-engineplugin-python"></a>linkis-engineplugin-python<a class="hash-link" href="#linkis-engineplugin-python" title="Direct link to heading">#</a></h4><p><a href="https://github.com/apache/incubator-linkis/commit/7a26e85c53fc7cd55ddefbd78b1748b00f85ddd6" target="_blank" rel="noopener noreferrer">Reference pr</a>
If resource / Python&#x27;s python In the PY file, there is import pandas as PD. If you do not want to install pandas, you need to remove it</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="linkis-label-common"></a>linkis-label-common<a class="hash-link" href="#linkis-label-common" title="Direct link to heading">#</a></h4><p>org.apache.linkis.manager.label.conf.LabelCommonConfig
Modify the default version to facilitate the use of subsequent self compilation scheduling components</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final CommonVars&lt;String&gt; SPARK_ENGINE_VERSION =</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            CommonVars.apply(&quot;wds.linkis.spark.engine.version&quot;, &quot;3.0.1&quot;);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public static final CommonVars&lt;String&gt; HIVE_ENGINE_VERSION =</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            CommonVars.apply(&quot;wds.linkis.hive.engine.version&quot;, &quot;3.1.2&quot;);</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="linkis-computation-governance-common"></a>linkis-computation-governance-common<a class="hash-link" href="#linkis-computation-governance-common" title="Direct link to heading">#</a></h4><p>org.apache.linkis.governance.common.conf.GovernanceCommonConf
Modify the default version to facilitate the use of subsequent self compilation scheduling components</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  val SPARK_ENGINE_VERSION = CommonVars(&quot;wds.linkis.spark.engine.version&quot;, &quot;3.0.1&quot;)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  val HIVE_ENGINE_VERSION = CommonVars(&quot;wds.linkis.hive.engine.version&quot;, &quot;3.1.2&quot;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="compile"></a>Compile<a class="hash-link" href="#compile" title="Direct link to heading">#</a></h4><p>Ensure that the above modifications and environments are available and implemented in sequence</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> incubator-linkis-x.x.x</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    mvn -N  </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    mvn clean </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> -DskipTests</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="compilation-error-troubleshooting"></a>Compilation error troubleshooting<a class="hash-link" href="#compilation-error-troubleshooting" title="Direct link to heading">#</a></h4><ul><li>If there is an error when you compile, try to enter a module to compile separately to see if there is an error and adjust it according to the specific error</li><li>For example, the following example (the py4j version does not adapt when the group Friends adapt to the lower version of CDH): if you encounter this problem, you can adjust the version with the corresponding method to determine whether to adapt</li></ul><p><img alt="image.png" src="/assets/images/linkis1-8a23252e4187925ce9aa3baf384fc782.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="dataspherestudio"></a>DataSphereStudio<a class="hash-link" href="#dataspherestudio" title="Direct link to heading">#</a></h3><p><a href="https://github.com/WeBankFinTech/DataSphereStudio/tree/1.1.0" target="_blank" rel="noopener noreferrer">Original project code address</a>
<a href="https://github.com/ruY9527/DataSphereStudio/tree/1.1.0-hadoop3.x" target="_blank" rel="noopener noreferrer">Adaptation modification code reference address</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="the-pom-file-of-dataspherestudio"></a>The pom file of DataSphereStudio<a class="hash-link" href="#the-pom-file-of-dataspherestudio" title="Direct link to heading">#</a></h4><p>Since DSS relies on linkis, all compilers should compile linkis before compiling DSS</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!-- scala consistent environment --&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">scala.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">2.12.10</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">scala.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dss-dolphinschuduler-token"></a>dss-dolphinschuduler-token<a class="hash-link" href="#dss-dolphinschuduler-token" title="Direct link to heading">#</a></h4><p>DolphinSchedulerTokenRestfulApi: Remove type conversion</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">responseRef.getValue(&quot;expireTime&quot;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="web-tuning"></a>web tuning<a class="hash-link" href="#web-tuning" title="Direct link to heading">#</a></h4><p> <a href="https://github.com/WeBankFinTech/DataSphereStudio-Doc/blob/main/zh_CN/%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/%E5%89%8D%E7%AB%AF%E7%BC%96%E8%AF%91%E6%96%87%E6%A1%A3.md" target="_blank" rel="noopener noreferrer">Front end compilation address</a>
<a href="https://github.com/WeBankFinTech/DataSphereStudio/commit/1dc9d99648e9f78b2dfb4776df4b9f46ef530c8a" target="_blank" rel="noopener noreferrer">Reference pr</a>
Overwrite the contents of the following directories from the master branch, or build the web based on the master branch
<img alt="image.png" src="/assets/images/dss1-20ef6540150ed9310355835fb507fbee.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="compile-1"></a>Compile<a class="hash-link" href="#compile-1" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> DataSphereStudio</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    mvn -N  </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    mvn clean </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> -DskipTests</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="schedulis"></a>Schedulis<a class="hash-link" href="#schedulis" title="Direct link to heading">#</a></h3><p><a href="https://github.com/WeBankFinTech/Schedulis/tree/release-0.7.0" target="_blank" rel="noopener noreferrer">Original project code address</a>
<a href="https://github.com/ruY9527/Schedulis/tree/release-0.7.0-hadoop.x" target="_blank" rel="noopener noreferrer">Adaptation modification code reference address</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="the-pom-file-of-schedulis"></a>The pom file of Schedulis<a class="hash-link" href="#the-pom-file-of-schedulis" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">hadoop.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">3.1.1</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">hadoop.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">hive.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">3.1.2</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">hive.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">spark.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">3.0.1</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">spark.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="azkaban-jobtype"></a>azkaban-jobtype<a class="hash-link" href="#azkaban-jobtype" title="Direct link to heading">#</a></h4><p>Download the jobtype file of the corresponding version (note the corresponding version): <a href="https://github.com/WeBankFinTech/Schedulis/blob/master/docs/schedulis_deploy_cn.md" target="_blank" rel="noopener noreferrer">Download address:</a>
After downloading, put the entire jobtypes under jobtypes
<img alt="image.png" src="/assets/images/schedulis1-3dd098ac55f1fff03d5466bf1acf503b.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="qualitis"></a>Qualitis<a class="hash-link" href="#qualitis" title="Direct link to heading">#</a></h3><p><a href="https://github.com/WeBankFinTech/Qualitis/tree/release-0.9.2" target="_blank" rel="noopener noreferrer">Original project code address</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="forgerock-package-download"></a>Forgerock package download<a class="hash-link" href="#forgerock-package-download" title="Direct link to heading">#</a></h4><p><a href="https://github.com/WeBankFinTech/Qualitis/releases" target="_blank" rel="noopener noreferrer">release地址</a> of <a href="https://github.com/WeBankFinTech/Qualitis/releases/tag/release-0.9.1" target="_blank" rel="noopener noreferrer">release-0.9.1</a>,after decompression, put it under. m2\repository\org</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="compile-2"></a>Compile<a class="hash-link" href="#compile-2" title="Direct link to heading">#</a></h4><p>Gradle version 4.6</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> Qualitis</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gradle clean distZip</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>After compiling, there will be a qualitis-0.9.2.zip file under qualitis
<img alt="image.png" src="/assets/images/qualitis1-8e3dba5b4b155e0c96ad3b1680ca7914.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dss-qualitis-appconn-compile"></a>dss-qualitis-appconn compile<a class="hash-link" href="#dss-qualitis-appconn-compile" title="Direct link to heading">#</a></h4><p>Copy the appconn to the appconns under datasphere studio (create the DSS quality appconn folder), as shown in the following figure:
Compile the DSS qualitis appconn. The qualitis under out is the package of integrating qualitis with DSS
<img alt="image.png" src="/assets/images/qualitis2-15148e52070389ee6491f08119d6445b.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="exchangis"></a>Exchangis<a class="hash-link" href="#exchangis" title="Direct link to heading">#</a></h3><p><a href="https://github.com/WeBankFinTech/Exchangis/tree/release-1.0.0" target="_blank" rel="noopener noreferrer">Original project code address</a>
<a href="https://github.com/ruY9527/Exchangis/tree/release-1.0.0-hadoop3.x" target="_blank" rel="noopener noreferrer">Adaptation modification code reference address</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="the-pom-file-of-exchangis"></a>The pom file of Exchangis<a class="hash-link" href="#the-pom-file-of-exchangis" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!-- scala Consistent version --&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">scala.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">2.12.10</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">scala.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="back-end-compilation"></a>Back end compilation<a class="hash-link" href="#back-end-compilation" title="Direct link to heading">#</a></h4><p><a href="https://github.com/WeBankFinTech/Exchangis/blob/dev-1.0.0/docs/zh_CN/ch1/exchangis_deploy_cn.md" target="_blank" rel="noopener noreferrer">Official compiled documents</a>
In the target package of the assembly package, wedatasphere-exchangis-1.0.0.tar.gz is its own service package
Linkis engineplug sqoop needs to be put into linkis (lib/linkis enginecon plugins)
Exchangis-appconn.zip needs to be put into DSS (DSS appconns)</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mvn clean install </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><img alt="image.png" src="/assets/images/exchangis1-4921fd02462370bd7c40cb7f9ceb7fb2.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="front-end-compilation"></a>Front end compilation<a class="hash-link" href="#front-end-compilation" title="Direct link to heading">#</a></h4><p>If you deploy the front-end using nginx yourself, you need to pay attention to the dist folder under dist
<img alt="image.png" src="/assets/images/exchangis2-e5f54b200065ab3ceec007472851d54a.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="visualis"></a>Visualis<a class="hash-link" href="#visualis" title="Direct link to heading">#</a></h3><p><a href="https://github.com/WeBankFinTech/Visualis/tree/v1.0.0" target="_blank" rel="noopener noreferrer">Original project code address</a>
<a href="https://github.com/ruY9527/Visualis/tree/v1.0.0-hadoop3.x" target="_blank" rel="noopener noreferrer">Adaptation modification code reference address</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="the-pom-file-of-visualis"></a>The pom file of Visualis<a class="hash-link" href="#the-pom-file-of-visualis" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">scala.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">2.12.10</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">scala.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="compile-3"></a>Compile<a class="hash-link" href="#compile-3" title="Direct link to heading">#</a></h4><p> <a href="https://github.com/WeBankFinTech/Visualis/blob/master/visualis_docs/zh_CN/Visualis_deploy_doc_cn.md" target="_blank" rel="noopener noreferrer">Official compiled documents</a>
In the target under assembly, visuis server zip is the package of its own service
The target of visualis appconn is visualis.zip, which is the package required by DSS (DSS appconns)
Build is the package printed by the front end</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd Visualis</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mvn -N install</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mvn clean package -DskipTests=true</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><img alt="image.png" src="/assets/images/visualis1-526c531225821a7aa99946d3a194ec18.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="streamis"></a>Streamis<a class="hash-link" href="#streamis" title="Direct link to heading">#</a></h3><p><a href="https://github.com/WeBankFinTech/Streamis/tree/0.2.0" target="_blank" rel="noopener noreferrer">Original project code address</a>
<a href="https://github.com/ruY9527/Streamis/tree/0.2.0-hadoop3.x" target="_blank" rel="noopener noreferrer">Adaptation modification code reference address</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="the-pom-file-of-streamis"></a>The pom file of Streamis<a class="hash-link" href="#the-pom-file-of-streamis" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">scala.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">2.12.10</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">scala.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The pom file of streamis-project-server</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!-- If you are 1.0.1 here, adjust it to ${dss.version} --&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">com.webank.wedatasphere.dss</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">dss-sso-integration-standard</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">${dss.version}</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">scope</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">compile</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">scope</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="compile-4"></a>Compile<a class="hash-link" href="#compile-4" title="Direct link to heading">#</a></h4><p> <a href="https://github.com/WeBankFinTech/Streamis/blob/main/docs/zh_CN/0.2.0/Streamis%E5%AE%89%E8%A3%85%E6%96%87%E6%A1%A3.md" target="_blank" rel="noopener noreferrer">Official compiled documents</a>
Under assembly, the target package wedatasphere-streams-0.2.0-dist.tar.gz is the package of its own back-end service
The stream.zip package of target under stream appconn is required by DSS (DSS appconns)
dist under dist is the front-end package</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd ${STREAMIS_CODE_HOME}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mvn -N install</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mvn clean install</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><img alt="image.png" src="/assets/images/streamis1-067a0add4da497c30b77a6c0aba3128a.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="installation-deployment"></a>Installation deployment<a class="hash-link" href="#installation-deployment" title="Direct link to heading">#</a></h2><p><a href="https://linkis.apache.org/zh-CN/docs/1.1.1/deployment/quick-deploy" target="_blank" rel="noopener noreferrer">Official deployment address</a>
<a href="https://linkis.apache.org/zh-CN/blog/2022/02/21/linkis-deploy" target="_blank" rel="noopener noreferrer">Common error address</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="path-unification"></a>Path unification<a class="hash-link" href="#path-unification" title="Direct link to heading">#</a></h3><p>It is recommended to deploy the relevant components in the same path (for example, I unzip them all in /home/hadoop/application)
<img alt="image.png" src="/assets/images/deploy1-74f8a7facb0f4a9de3d43c233bcbb29c.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="notes-on-linkis-deployment"></a>Notes on linkis deployment<a class="hash-link" href="#notes-on-linkis-deployment" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="deploy-config-folder"></a>Deploy config folder<a class="hash-link" href="#deploy-config-folder" title="Direct link to heading">#</a></h4><p>db.sh, the address of the links connection configured by mysql, and the metadata connection address of hive
linkis-env.sh</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">-- The path to save the script script. Next time, there will be a folder with the user&#x27;s name, and the script of the corresponding user will be stored </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> this folder</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">WORKSPACE_USER_ROOT_PATH</span><span class="token operator">=</span><span class="token plain">file:///home/hadoop/logs/linkis</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-- Log files </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> storing materials and engine execution</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">HDFS_USER_ROOT_PATH</span><span class="token operator">=</span><span class="token plain">hdfs:///tmp/linkis</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-- Log of each execution of the engine and information related to starting engineconnexec.sh</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">ENGINECONN_ROOT_PATH</span><span class="token operator">=</span><span class="token plain">/home/hadoop/logs/linkis/apps</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-- Access address of </span><span class="token function" style="color:rgb(80, 250, 123)">yarn</span><span class="token plain"> master node </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">active resource manager</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">YARN_RESTFUL_URL</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-- Conf address of Hadoop / hive / spark</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">HADOOP_CONF_DIR</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">HIVE_CONF_DIR</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SPARK_CONF_DIR</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-- Specify the corresponding version</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SPARK_VERSION</span><span class="token operator">=</span><span class="token number">3.0</span><span class="token plain">.1</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">HIVE_VERSION</span><span class="token operator">=</span><span class="token number">3.1</span><span class="token plain">.2</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-- Specify the path after the installation of linkis. For example, I agree to specify the path under the corresponding component here</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">LINKIS_HOME</span><span class="token operator">=</span><span class="token plain">/home/hadoop/application/linkis/linkis-home</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="flink"></a>flink<a class="hash-link" href="#flink" title="Direct link to heading">#</a></h4><p>If you use Flink, you can try importing it from <a target="_blank" href="/assets/files/flink-engine-2a1a0199ef097db16d2d0238005245e3.sql">flink-engine.sql</a>  into the database of linkis</p><p>Need to modify @Flink_LABEL version is the corresponding version, and the queue of yarn is default by default</p><p>At the same time, in this version, if you encounter the error of &quot;1g&quot; converting digital types, try to remove the 1g unit and the regular check rules. Refer to the following:</p><p><img alt="flink3.png" src="/assets/images/flink3-7e851b84808cf7d6116653a6978ca63d.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="lzo"></a>lzo<a class="hash-link" href="#lzo" title="Direct link to heading">#</a></h4><p>If your hive uses LZO, copy the corresponding LZO jar package to the hive path. For example, the following path:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">lib/linkis-engineconn-plugins/hive/dist/v3.1.2/lib</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="frequently-asked-questions-and-precautions"></a>Frequently asked questions and precautions<a class="hash-link" href="#frequently-asked-questions-and-precautions" title="Direct link to heading">#</a></h4><ul><li>The MySQL driver package must be copied to /lib/linkis-commons/public-module/ and /lib/linkis-spring-cloud-services/linkis-mg-gateway/</li><li>Initialization password in conf/linkis-mg-gateway.properties -&gt; wds.linkis.admin.password</li><li>ps-cs in the startup script,there may be failures, if any,use sh linkis-daemon.sh ps-cs , start it separately</li><li>At present, if there is time to back up the log, sometimes if the previous error log cannot be found, it may be backed up to the folder of the corresponding date</li><li>At present lib/linkis-engineconn-plugins have only spark/shell/python/hive,If you want appconn, flink and sqoop, go to DSS, linkis and exchangis to get them</li><li>Configuration file version check</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">linkis.properties,flink see </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> it is used</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.spark.engine.version</span><span class="token operator">=</span><span class="token number">3.0</span><span class="token plain">.1</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.hive.engine.version</span><span class="token operator">=</span><span class="token number">3.1</span><span class="token plain">.2</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.flink.engine.version</span><span class="token operator">=</span><span class="token number">1.13</span><span class="token plain">.2</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><img alt="image.png" src="/assets/images/deploy2-cc5f46ae416646c300738e32a63754fe.png">
<img alt="image.png" src="/assets/images/deploy3-a07614a61a4284be9bb0ad32c1ac6045.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="error-record"></a>Error record<a class="hash-link" href="#error-record" title="Direct link to heading">#</a></h4><ol><li>Incompatible versions. If you encounter the following error, it is whether the scala version is not completely consistent. Check and compile it</li></ol><p><img alt="1905943989d7782456c356b6ce0d72b.png" src="/assets/images/deploy4-fe0bda10b58063c12e25064aabcc9b8d.png"></p><ol start="2"><li>Yarn configures the active node address. If the standby address is configured, the following error will appear:</li></ol><p><img alt="1ca32f79d940016d72bf1393e4bccc8.jpg" src="/assets/images/deploy5-9a10e4fd895a0dd493b263f827fe9f92.jpg"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="considerations-for-dss-deployment"></a>Considerations for DSS deployment<a class="hash-link" href="#considerations-for-dss-deployment" title="Direct link to heading">#</a></h3><p><a href="https://github.com/WeBankFinTech/DataSphereStudio-Doc/tree/main/zh_CN" target="_blank" rel="noopener noreferrer">Official installation document</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="config-folder"></a>config folder<a class="hash-link" href="#config-folder" title="Direct link to heading">#</a></h4><p>db.sh: configure the database of DSS
config.sh</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">-- The installation path of DSS, </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> example, is defined </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> the folder under DSS</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">DSS_INSTALL_HOME</span><span class="token operator">=</span><span class="token plain">/home/hadoop/application/dss/dss</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="conf-folder"></a>conf folder<a class="hash-link" href="#conf-folder" title="Direct link to heading">#</a></h4><p>dss.properties</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI properties"><pre tabindex="0" class="prism-code language-properties codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Mainly check whether spark / hive and other versions are available. If not, add</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.spark.engine.version=3.0.1</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.hive.engine.version=3.1.2</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.flink.engine.version=1.13.2</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>dss-flow-execution-server.properties</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI properties"><pre tabindex="0" class="prism-code language-properties codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Mainly check whether spark / hive and other versions are available. If not, add</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.spark.engine.version=3.0.1</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.hive.engine.version=3.1.2</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.flink.engine.version=1.13.2</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If you want to use dolphin scheduler for scheduling, please add the corresponding spark / hive version to this pr
<a href="https://github.com/WeBankFinTech/DataSphereStudio/pull/914/files" target="_blank" rel="noopener noreferrer">Reference pr</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dss-appconns"></a>dss-appconns<a class="hash-link" href="#dss-appconns" title="Direct link to heading">#</a></h4><p>Exchangis, qualitis, streamis and visualis should be obtained from the projects of exchangis, qualitis, streamis and visualis respectively</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="frequently-asked-questions-and-precautions-1"></a>Frequently asked questions and precautions<a class="hash-link" href="#frequently-asked-questions-and-precautions-1" title="Direct link to heading">#</a></h4><ul><li>Since we integrate scheduleis, qualitis, exchangis and other components into DSS, all the interfaces of these components will be called synchronously when creating a project, so we ensure that dss_appconn_instance  configuration paths in the instance are correct and accessible</li><li>The Chrome browser recommends that the kernel use version 100 or below. Otherwise, there will be a problem that you can separate scdulis, qaulitis and other components, but you cannot log in successfully through DSS</li><li>Hostname and IP. If IP access is used, make sure it is IP when executing appconn-install.sh installation Otherwise, when accessing other components, you will be prompted that you do not have login or permission</li></ul><p><img alt="ec4989a817646f785c59f6802d0fab2.jpg" src="/assets/images/deploy6-93dece9bd52296bfd4a8269e387f6be0.jpg"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="schedulis-deployment-considerations"></a>Schedulis deployment considerations<a class="hash-link" href="#schedulis-deployment-considerations" title="Direct link to heading">#</a></h3><p> <a href="https://github.com/WeBankFinTech/Schedulis/blob/master/docs/schedulis_deploy_cn.md" target="_blank" rel="noopener noreferrer">Official deployment document</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="conf-folder-1"></a>conf folder<a class="hash-link" href="#conf-folder-1" title="Direct link to heading">#</a></h4><p>azkaban.properties</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI properties"><pre tabindex="0" class="prism-code language-properties codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># azkaban.jobtype.plugin.dir and executor.global.properties. It&#x27;s better to change the absolute path here</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Azkaban JobTypes Plugins</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">azkaban.jobtype.plugin.dir=/home/hadoop/application/schedulis/apps/schedulis_0.7.0_exec/plugins/jobtypes</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Loader for projects</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">executor.global.properties=/home/hadoop/application/schedulis/apps/schedulis_0.7.0_exec/conf/global.properties</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Engine version</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.spark.engine.version=3.0.1</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.hive.engine.version=3.1.2</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wds.linkis.flink.engine.version=1.13.2</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="web-modular"></a>web modular<a class="hash-link" href="#web-modular" title="Direct link to heading">#</a></h4><p>plugins/viewer/system/conf:  Here, you need to configure the database connection address to be consistent with scheduleis
azkaban.properties:  Configuration of user parameters and system management</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI properties"><pre tabindex="0" class="prism-code language-properties codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">viewer.plugins=system</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">viewer.plugin.dir=/home/hadoop/application/schedulis/apps/schedulis_0.7.0_web/plugins/viewer</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="frequently-asked-questions-and-precautions-2"></a>Frequently asked questions and precautions<a class="hash-link" href="#frequently-asked-questions-and-precautions-2" title="Direct link to heading">#</a></h4><p>If there are resources or there are no static files such as CSS in the web interface, change the relevant path to an absolute path
If the configuration file cannot be loaded, you can also change the path to an absolute path
For example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">### web module</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">web.resource.dir=/home/hadoop/application/schedulis/apps/schedulis_0.7.0_web/web/</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">viewer.plugin.dir=/home/hadoop/application/schedulis/apps/schedulis_0.7.0_web/plugins/viewer</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">### exec module</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">azkaban.jobtype.plugin.dir=/home/hadoop/application/schedulis/apps/schedulis_0.7.0_exec/plugins/jobtypes</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">executor.global.properties=/home/hadoop/application/schedulis/apps/schedulis_0.7.0_exec/conf/global.properties</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="considerations-for-qualitis-deployment"></a>Considerations for qualitis deployment<a class="hash-link" href="#considerations-for-qualitis-deployment" title="Direct link to heading">#</a></h3><p><a href="https://github.com/WeBankFinTech/Qualitis/blob/master/docs/zh_CN/ch1/%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E6%89%8B%E5%86%8C%E2%80%94%E2%80%94%E5%8D%95%E6%9C%BA%E7%89%88.md" target="_blank" rel="noopener noreferrer">Official deployment document</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="conf-folder-2"></a>conf folder<a class="hash-link" href="#conf-folder-2" title="Direct link to heading">#</a></h4><p>application-dev.yml</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI properties"><pre tabindex="0" class="prism-code language-properties codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  # The correct spark version is configured here</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  spark:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    application:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      name: IDE</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      reparation: 50</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    engine:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      name: spark</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      version: 3.0.1</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="exchange-deployment-considerations"></a>Exchange deployment considerations<a class="hash-link" href="#exchange-deployment-considerations" title="Direct link to heading">#</a></h3><p><a href="https://github.com/WeBankFinTech/Exchangis/blob/dev-1.0.0/docs/zh_CN/ch1/exchangis_deploy_cn.md" target="_blank" rel="noopener noreferrer">Official deployment document</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="frequently-asked-questions-and-precautions-3"></a>Frequently asked questions and precautions<a class="hash-link" href="#frequently-asked-questions-and-precautions-3" title="Direct link to heading">#</a></h4><p>If you click the data source and there is an error that has not been published, you can try to add linkis<em>ps_dm_datasource</em> -&gt; published_version_id Modify the published_version_id value to 1 (if it is null)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="visualis-1"></a>Visualis<a class="hash-link" href="#visualis-1" title="Direct link to heading">#</a></h3><p><a href="https://github.com/WeBankFinTech/Visualis/blob/master/visualis_docs/zh_CN/Visualis_deploy_doc_cn.md" target="_blank" rel="noopener noreferrer">Official deployment document</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="frequently-asked-questions-and-precautions-4"></a>Frequently asked questions and precautions<a class="hash-link" href="#frequently-asked-questions-and-precautions-4" title="Direct link to heading">#</a></h4><p>If the preview view is inconsistent, please check whether the bin / phantomjs file is uploaded completely
If you can see the following results, the upload is complete</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI properties"><pre tabindex="0" class="prism-code language-properties codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">./phantomjs -v</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2.1.1</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="streamis-1"></a>Streamis<a class="hash-link" href="#streamis-1" title="Direct link to heading">#</a></h3><p> <a href="https://github.com/WeBankFinTech/Streamis/blob/main/docs/zh_CN/0.2.0/Streamis%E5%AE%89%E8%A3%85%E6%96%87%E6%A1%A3.md" target="_blank" rel="noopener noreferrer">Official deployment document</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="dss-appconn"></a>dss-appconn<a class="hash-link" href="#dss-appconn" title="Direct link to heading">#</a></h3><p>Qualitis, exchangis, streams and visualis are compiled from various modules, copied to DSS appconns under DSS, and then executed appconn-install.sh under bin to install their components
If you find the following SQL script errors during integration, please check whether there are comments around the wrong SQL. If so, delete the comments and try appconn install again
<img alt="903ceec2f69fc1c7a2be5f309f69726.png" src="/assets/images/deploy7-3d8d21245d502290cf376d396905122c.png">
For example, for qualitis, the following IP and host ports are determined according to their specific use</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">qualitis</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">172.21.129.78</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">8090</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="nginx-deployment-example"></a>Nginx deployment example<a class="hash-link" href="#nginx-deployment-example" title="Direct link to heading">#</a></h2><p> linkis.conf:   dss/linkis/visualis front end
exchangis.conf:  exchangis front end
streamis.conf:      streamis front end
Scheduling and Qaulitis are in their own projects
Linkis / Visualis needs to change the dist or build packaged from the front end to the name of the corresponding component here
<img alt="image.png" src="/assets/images/deploy8-3db0b22721e52b2f2b8b389637b8ead7.png">
<img alt="image.png" src="/assets/images/deploy9-363fc68aa5231009c4a649fa457e8e3a.png">
<img alt="image.png" src="/assets/images/deploy10-4c6b8e7214798a09d2d7245cdbb25b4a.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="linkisconf"></a>linkis.conf<a class="hash-link" href="#linkisconf" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">server {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">listen       8089;# Access port:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server_name  localhost;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#charset koi8-r;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#access_log  /var/log/nginx/host.access.log  main;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">location /dss/visualis {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Modify to your own front-end path</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root   /home/hadoop/application/webs; # Static file directory</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">autoindex on;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">location /dss/linkis {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Modify to your own front-end path</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root   /home/hadoop/application/webs; # linkis Static file directory of management console</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">autoindex on;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">location / {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Modify to your own front-end path</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root   /home/hadoop/application/webs/dist; # Static file directory</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#root /home/hadoop/dss/web/dss/linkis;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index  index.html index.html;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">location /ws {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy_pass http://172.21.129.210:9001;#Address of back-end linkis</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy_http_version 1.1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy_set_header Upgrade $http_upgrade;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy_set_header Connection upgrade;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">location /api {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy_pass http://172.21.129.210:9001; #Address of back-end linkis</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy_set_header Host $host;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy_set_header X-Real-IP $remote_addr;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy_set_header x_real_ipP $remote_addr;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy_set_header remote_addr $remote_addr;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy_http_version 1.1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy_connect_timeout 4s;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy_read_timeout 600s;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy_send_timeout 12s;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy_set_header Upgrade $http_upgrade;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy_set_header Connection upgrade;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#error_page  404              /404.html;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># redirect server error pages to the static page /50x.html</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">error_page   500 502 503 504  /50x.html;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">location = /50x.html {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root   /usr/share/nginx/html;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="exchangisconf"></a>exchangis.conf<a class="hash-link" href="#exchangisconf" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">server {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            listen       9800; # Access port: if the port is occupied, it needs to be modified</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            server_name  localhost;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            #charset koi8-r;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            #access_log  /var/log/nginx/host.access.log  main;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            location / {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            # Modify to own path</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            root   /home/hadoop/application/webs/exchangis/dist/dist; #Modify to your own path</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            autoindex on;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            location /api {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            proxy_pass http://172.21.129.210:9001;  # The address of the backend link needs to be modified</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            proxy_set_header Host $host;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            proxy_set_header X-Real-IP $remote_addr;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            proxy_set_header x_real_ipP $remote_addr;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            proxy_set_header remote_addr $remote_addr;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            proxy_http_version 1.1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            proxy_connect_timeout 4s;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            proxy_read_timeout 600s;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            proxy_send_timeout 12s;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            proxy_set_header Upgrade $http_upgrade;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            proxy_set_header Connection upgrade;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            #error_page  404              /404.html;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            # redirect server error pages to the static page /50x.html</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            #</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            error_page   500 502 503 504  /50x.html;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            location = /50x.html {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            root   /usr/share/nginx/html;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="streamisconf"></a>streamis.conf<a class="hash-link" href="#streamisconf" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">server {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    listen       9088;# Access port: if the port is occupied, it needs to be modified</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    server_name  localhost;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    location / {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    # Modify to your own path</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        root   /home/hadoop/application/webs/streamis/dist/dist;  #Modify to your own path</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        index  index.html index.html;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    location /api {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_pass http://172.21.129.210:9001;        # The address of the backend link needs to be modified</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_set_header Host $host;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_set_header X-Real-IP $remote_addr;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_set_header x_real_ipP $remote_addr;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_set_header remote_addr $remote_addr;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_http_version 1.1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_connect_timeout 4s;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_read_timeout 600s;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_send_timeout 12s;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_set_header Upgrade $http_upgrade;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    proxy_set_header Connection upgrade;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    #error_page  404              /404.html;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    # redirect server error pages to the static page /50x.html</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    #</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    error_page   500 502 503 504  /50x.html;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    location = /50x.html {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    root   /usr/share/nginx/html;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/blog">blog</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/linki-1-1-1">linki1.1.1</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/hadoop-3-1-1">hadoop3.1.1</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/spark-3-0-1">spark3.0.1</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/hive-3-1-2">hive3.1.2</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/flink-1-13-2">flink1.13.2</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/blog/2022/07/16/deploy-linkis-with-kubernetes">Deploy Linkis with Kubernetes</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-07-16T00:00:00.000Z" itemprop="datePublished">July 16, 2022</time> · 3 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/jacktao007" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://avatars.githubusercontent.com/u/1073365?v=4" alt="jacktao"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/jacktao007" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">jacktao</span></a></div><small class="avatar__subtitle" itemprop="description">contributors</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><strong>1. Dependencies and versions</strong></p><p>kind github：<a href="https://github.com/kubernetes-sigs/kind" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes-sigs/kind</a></p><p>kind website：<a href="https://kind.sigs.k8s.io/" target="_blank" rel="noopener noreferrer">kind.sigs.k8s.io/</a></p><p>version:</p><p>kind 0.14.0</p><p>docker  20.10.17</p><p>node v14.19.3</p><p>Note:</p><ol><li><p>Ensure that the front and back ends can compile properly</p></li><li><p>Ensure that the component depends on the version</p></li><li><p>Kind refers to the machine that uses docker container to simulate nodes. When the machine is restarted, the scheduler does not work because the container is changed.</p></li></ol><p><strong>2.Install the docker</strong></p><p>（1）Install the tutorial</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo sed -i &#x27;s+download.docker.com+mirrors.aliyun.com/docker-ce+&#x27; /etc/yum.repos.d/docker-ce.repo</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo yum makecache fast</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo yum -y install docker-ce</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">systemctl start docker</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">systemctl enable docker</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>（2）setting image mirrors</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">vi /etc/docker/daemon.json</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;registry-mirrors&quot;: [&quot;http://hub-mirror.c.163.com&quot;],</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;insecure-registries&quot;: [&quot;https://registry.mydomain.com&quot;,&quot;http://hub-mirror.c.163.com&quot;]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>3.install the kind</strong></p><p>（1）Manually download the Kind binary</p><p><a href="https://github.com/kubernetes-sigs/kind/releases" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes-sigs/kind/releases</a></p><p>（2）Install kind binary</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">chmod +x ./kind</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mv kind-linux-amd64 /usr/bin/kind</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>4.Install the JDK and Maven</strong></p><p>（1）Refer to the general installation tutorial to install the following components</p><p>jdk 1.8</p><p>mavne 3.5+</p><p><strong>5.Install the NodeJS</strong></p><p>（1）version</p><p>node v14.19.3</p><p>（2）install the nvm</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">export http_proxy=http://10.0.0.150:7890</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">export https_proxy=http://10.0.0.150:7890</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">export NVM_DIR=&quot;$HOME/.nvm&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[ -s &quot;$NVM_DIR/nvm.sh&quot; ] &amp;&amp; \. &quot;$NVM_DIR/nvm.sh&quot;  # This loads nvm</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[ -s &quot;$NVM_DIR/bash_completion&quot; ] &amp;&amp; \. &quot;$NVM_DIR/bash_completion&quot;  # This loads nvm bash_completion</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>（3）install the nodejs</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">nvm ls-remote</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nvm install v14.19.3</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>（4）setting NPM</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">npm config set registry https://registry.npmmirror.com</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">npm config set sass_binary_site https://registry.npmmirror.com/binary.html?path=node-sass/</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>（5）Compiler front-end</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">npm install -g yarn</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">yarn</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">yarn build</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">yarn </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>6.Compile linkis</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># 1. When compiling for the first time, execute the following command first</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./mvnw -N install</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># 2. make the linkis distribution package</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># - Option 1: make the linkis distribution package only</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./mvnw clean install -Dmaven.javadoc.skip=true -Dmaven.test.skip=true</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># - Option 2: make the linkis distribution package and docker image</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./mvnw clean install -Pdocker -Dmaven.javadoc.skip=true -Dmaven.test.skip=true</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># - Option 3: linkis distribution package and docker image (included web)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./mvnw clean install -Pdocker -Dmaven.javadoc.skip=true -Dmaven.test.skip=true -Dlinkis.build.web=true</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>7.Create the cluster</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">dos2unix ./linkis-dist/helm/scripts/*.sh</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./linkis-dist/helm/scripts/create-test-kind.sh</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>8.install the helm charts</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ./scripts/install-charts.sh linkis linkis-demo</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>9.Visit the Linkis page</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl port-forward -n linkis  --address=0.0.0.0 service/linkis-demo-web 8087:8087</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://10.0.2.101:8087</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>10.Test using the Linkis client</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl -n linkis exec -it linkis-demo-ps-publicservice-77d7685d9-f59ht -- bash</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./linkis-cli -engineType shell-1 -codeType shell -code &quot;echo \&quot;hello\&quot; &quot;  -submitUser hadoop -proxyUser hadoop</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>11.install the kubectl</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[kubernetes]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">name=Kubernetes</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">enabled=1</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gpgcheck=1</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repo_gpgcheck=1</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EOF</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">yum install -y --nogpgcheck kubectl</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl config view  </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl config get-contexts  </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">kubectl cluster-info  </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/github">github</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/blog/2022/07/04/how-to-add-auto-bot">How to add a GitHub Action for the GitHub repository</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-07-04T00:00:00.000Z" itemprop="datePublished">July 4, 2022</time> · 9 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/Beacontownfc/" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://avatars.githubusercontent.com/u/89081023?s=40&amp;v=4" alt="BeaconTown"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/Beacontownfc/" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">BeaconTown</span></a></div><small class="avatar__subtitle" itemprop="description">Student</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="1-summary"></a>1 Summary<a class="hash-link" href="#1-summary" title="Direct link to heading">#</a></h2><p>As you know, <a href="#21-what-is-continuous-integration">continuous integration</a> consists of many operations, such as capturing code, running tests, logging in to remote servers, publishing to third-party services, and so on. GitHub calls these operations as Actions. Many operations are similar in different projects and can be shared. GitHub noticed this and came up with a wonderful idea to allow developers to write each operation as an independent script file and store it in the code repository so that other developers can reference it. If you need an action, you don&#x27;t have to write a complex script by yourself. You can directly reference the action written by others. The whole continuous integration process becomes a combination of actions. This is the most special part of GitHub Actions.</p><p>GitHub provides a <a href="https://github.com/marketplace" target="_blank" rel="noopener noreferrer">Github Action Market</a> for developers, we can find the GitHub Action we want from this market and configure it into the <code>workflow</code> of the repository to realize automatic operation. Of course, the GitHub Action that this market can provide is limited. In some cases, we can&#x27;t find a GitHub Action that can meet our needs. I will also teach you how to write GitHub Action by yourself later in this blog.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="2-some-terms"></a>2 Some terms<a class="hash-link" href="#2-some-terms" title="Direct link to heading">#</a></h2><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="21-what-is-continuous-integration"></a>2.1 What is continuous integration<a class="hash-link" href="#21-what-is-continuous-integration" title="Direct link to heading">#</a></h4><p>In short, it is an automated program. For example, every time the front-end programmer submits code to GitHub&#x27;s repository, GitHub will automatically create a virtual machine (MAC / Windows / Linux) to execute one or more instructions (determined by us), for example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">npm</span><span class="token plain"> run build</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="22-what-is-yaml"></a>2.2 What is YAML<a class="hash-link" href="#22-what-is-yaml" title="Direct link to heading">#</a></h4><p>The way we integrate GitHub Action is to create a <code>Github/workflow</code> directory, with a <code>* yaml</code> file - this <code>yaml</code> file is the file we use to configure GitHub Action. It is a very easy scripting language. For users who are not familiar with <code>yaml</code>, you can refer to it <a href="https://www.codeproject.com/Articles/1214409/Learn-YAML-in-five-minutes" target="_blank" rel="noopener noreferrer">here</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="3-start-writing-the-first-workflow"></a>3 Start writing the first Workflow<a class="hash-link" href="#3-start-writing-the-first-workflow" title="Direct link to heading">#</a></h2><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="31-how-to-customize-the-name-of-workflow"></a>3.1 How to customize the name of Workflow<a class="hash-link" href="#31-how-to-customize-the-name-of-workflow" title="Direct link to heading">#</a></h4><p>GitHub displays the name of the Workflow on the action page of the repository. If we omit name, GitHub will set it as the Workflow file path relative to the repository root directory.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Say Hello</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="32-how-to-customize-the-trigger-event-of-workflow"></a>3.2 How to customize the trigger event of Workflow<a class="hash-link" href="#32-how-to-customize-the-trigger-event-of-workflow" title="Direct link to heading">#</a></h4><p>There are many events, for example, the user submits a pull request to the repository, the user submits an issue to the repository, or the user closes an issue, etc. We hope that when some events occur, the Workflow will be automatically executed, which requires the definition of trigger events. The following is an example of a custom trigger event:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yml"><pre tabindex="0" class="prism-code language-yml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Say Hello</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">on</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  pull_request</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The above code can trigger workflow when the user submits a pull request. For multiple events, we enclose them in square brackets, for example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yml"><pre tabindex="0" class="prism-code language-yml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Say Hello</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">on</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">pull_request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">pull</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Of course, we hope that the triggering event can be more specific, such as triggering Workflow when a pull request is closed or reopened:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yml"><pre tabindex="0" class="prism-code language-yml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Say Hello</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">on</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">pull_request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">reopend</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">closed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>For more trigger events, please refer to <a href="https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#about-workflow-events" target="_blank" rel="noopener noreferrer">document</a> here.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="33-how-to-define-a-job"></a>3.3 How to define a job<a class="hash-link" href="#33-how-to-define-a-job" title="Direct link to heading">#</a></h4><p>A Workflow is composed of one or more jobs, which means that a continuous integration run can complete multiple tasks. Here is an example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yml"><pre tabindex="0" class="prism-code language-yml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Say Hello</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">on</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  pull_request</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">jobs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">my_first_job</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> My first job</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">my_second_job</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> My second job</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Each job must have an ID associated with it. Above <code>my_ first_ Job</code> and <code>my_ second_ Job</code> is the ID of the job.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="34-how-to-specify-the-running-environment-of-a-job"></a>3.4 How to specify the running environment of a job<a class="hash-link" href="#34-how-to-specify-the-running-environment-of-a-job" title="Direct link to heading">#</a></h4><p>Specify the running environment for running jobs. The operating systems available on Workflow are:</p><ul><li>Windows</li><li>macos</li><li>linux</li></ul><p>The following is an example of a specified running environment:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yml"><pre tabindex="0" class="prism-code language-yml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Limited by space, the previous code is omitted</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">jobs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">my_first_job</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> My first job</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">runs-on</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> macos</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token number">10.15</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="35-the-use-of-step"></a>3.5 The use of step<a class="hash-link" href="#35-the-use-of-step" title="Direct link to heading">#</a></h4><p>Each job is composed of multiple steps, which will be executed from top to bottom. Step can run commands (such as linxu commands) and actions.</p><p>The following is an example of outputting &quot;Hello World&quot;:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yml"><pre tabindex="0" class="prism-code language-yml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Limited by space, the previous code is omitted</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">jobs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">my_first_job</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> My first job</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">runs-on</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> macos</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token number">10.15</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">step</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Print a greeting</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Define the environment variables of step</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">FIRST_WORD</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Hello</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">SECOND_WORD</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> WORD</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># Run instructions: output environment variables</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token scalar string" style="color:rgb(255, 121, 198)"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token scalar string" style="color:rgb(255, 121, 198)">        echo $FIRST_WORD $SECOND_WORD.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Next is the use of action, which is actually a command. For example, GitHub officially gives us some <a href="https://github.com/marketplace?type=actions&amp;query=actions" target="_blank" rel="noopener noreferrer">default commands</a>. We can directly use these commands to reduce the amount of Workflow code in the repository. The most common action is <a href="https://link.zhihu.com/?target=https%3A//github.com/marketplace/actions/checkout" target="_blank" rel="noopener noreferrer">Checkout</a>, it can clone the latest code in the repository into the Workflow workspace.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yml"><pre tabindex="0" class="prism-code language-yml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Limited by space, the previous code is omitted</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">step</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Check out git repository </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> actions/checkout@v2</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Some actions require additional parameters to be passed in. Generally, <code>with</code> is used to set the parameter value:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yml"><pre tabindex="0" class="prism-code language-yml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Limited by space, the previous code is omitted</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">step</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Check out git repository </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> actions/checkout@v2</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> actions/setup</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">node@v2.2.0</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">with</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">node-version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">14</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="4-how-to-write-your-own-action"></a>4 How to write your own action<a class="hash-link" href="#4-how-to-write-your-own-action" title="Direct link to heading">#</a></h2><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="41-configuration-of-actionyml"></a>4.1 Configuration of action.yml<a class="hash-link" href="#41-configuration-of-actionyml" title="Direct link to heading">#</a></h4><p>When we can&#x27;t find the action we want in the GitHub Action Market, we can write an action to meet our needs by ourselves. The customized action needs to be created a new <code>&quot;actions&quot;</code> directory under the <code>&quot;.gitHub/workflow&quot;</code> directory, and then create a directory with a custom action name. Each action needs an action configuration file: <code>action.yml</code>. The <code>runs</code> section of <code>action.yml</code> specifies the starting mode of the operation. There are three startup methods: <code>node.js Script</code>, <code>Docker Image</code>, and <code>Composite Script</code>. The common parameters of <code>action.yml</code> are described below:</p><ul><li>name: Customize the name of the action</li><li>description: Declare the parameters or outputs that need to be passed in for action</li><li>inputs: Customize the parameters to be input</li><li>outputs: Output variables</li><li>runs: Startup mode</li></ul><p>The following is a configuration example of <code>action.yml</code>：</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yml"><pre tabindex="0" class="prism-code language-yml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;example action&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;This is an example action&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">inputs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">param1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;The first param of this action&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">#Required parameters must be set to true</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">param2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;The second param of this action&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">outputs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">out1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;The outputs of this action&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">runs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">using</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> node16</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">main</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> dist/index.js</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">post</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> dist/index.js</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Setting <code>runs.using</code> to <code>node16</code> or <code>node12</code> can be specified as the starting <code>node.js</code> script. The script file named <code>main</code> is the startup file. The way to start is similar to running the command <code>node main.js</code> directly. Therefore, dependency will not be installed from <code>package.json</code>. During development, we usually use the packaging tool to package the dependencies together, output a separate <code>JS</code> file, and then use this file as the entry point. The <code>runs.post</code> can specify the cleanup work, and the content here will be run at the end of the Workflow.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="42-using-docker-image"></a>4.2 Using Docker Image<a class="hash-link" href="#42-using-docker-image" title="Direct link to heading">#</a></h4><p>If Docker is used, we need to modify the <code>runs</code> in <code>action.yml</code> to:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yml"><pre tabindex="0" class="prism-code language-yml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">runs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">using</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> docker</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Dockerfile</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><code>runs.image</code> specifies the dockerfile required for image startup, which is specified here as the dockerfile under the project root directory. In the dockerfile, specify the startup script with <code>ENTRYPOINT</code> or <code>CMD</code>. For example, define a program that runs scripts in <code>Python</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI docker"><pre tabindex="0" class="prism-code language-docker codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">FROM python:3</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN pip install --no-cache-dir requests</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">COPY . .</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CMD [ &quot;python&quot;, &quot;/main.py&quot;]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Here we can see the advantages of using docker: you can customize the running environment, and you can use other program languages.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="5-github-action-project-practice"></a>5 GitHub Action project practice<a class="hash-link" href="#5-github-action-project-practice" title="Direct link to heading">#</a></h2><p>In this section, I will describe how to write your own GitHub Action with a specific example.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor anchor__h5 anchorWithStickyNavbar_y2LR" id="problem"></a>Problem<a class="hash-link" href="#problem" title="Direct link to heading">#</a></h5><p>Assuming that there are many issues to be processed in our GitHub repository, each pull request submitted by the user may be associated with an issue. If you have to manually close an issue after merging a pull request, it will be quite cumbersome.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor anchor__h5 anchorWithStickyNavbar_y2LR" id="resolve"></a>Resolve<a class="hash-link" href="#resolve" title="Direct link to heading">#</a></h5><p>Then workflow comes in handy. We can listen to the closed event of pull request and determine whether the closed event is closed by merged or non merged. If it is merged, the associated issue will be closed.</p><p>But there is still a problem here, how to obtain the associated issue? We can ask the user to add the issue that needs to be associated in the description part when submitting the pull request, such as <code>#345</code>, and then extract the issue number of <code>345</code>. How to realize this function? We can write GitHub Action by ourselves. In order to make the GitHub Action program more concise, here I use docker to start GitHub Action. First, prepare <code>action.yml</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yml"><pre tabindex="0" class="prism-code language-yml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># The name of Github Action </span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Auto_close_associate_issue&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># The description of action</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Auto close an issue which associate with a PR.&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Define parameters to be input</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">inputs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># The name of first param is prbody</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">prbody</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># The definition of the param</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;The body of the PR to search for related issues&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Required param</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">required</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">outputs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">#The name of output param</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">issurNumber</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;The issue number&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">runs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Using Docker Image</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">using</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;docker&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Dockerfile&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The next step is to write script files, where I use <code>node.js</code>. The idea of this script is: first obtain the variable value from the environment, extract the issue number, and then output it to the environment. The corresponding script (named main.js) is as follows:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// Get environment variables. All parameters passed to GitHub Action are capitalized and the prefix INPUT_ is required, which is specified by GitHub</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> body </span><span class="token operator">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;INPUT_PRBODY&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// Extract the number of issue by regular expression</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> pattern </span><span class="token operator">=</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">#\d+</span><span class="token regex regex-delimiter">/</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> issueNumber </span><span class="token operator">=</span><span class="token plain"> body</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">match</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">pattern</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">replace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;#&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// Output the issue number to the environment</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token template-string string" style="color:rgb(255, 121, 198)">::set-output name=issueNumber::</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">${</span><span class="token template-string interpolation">issueNumber</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Next is the image file of Docker (the file name is <code>Dockerfile</code>):</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yml"><pre tabindex="0" class="prism-code language-yml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">FROM node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">10.15</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">COPY . .</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CMD </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;node&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/main.js&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Finally, <code>action.yml</code>, <code>Dockerfile</code> and <code>main.js</code> is under the directory <code>.github/actions/Auto_close_associate_issue</code>, and the writing of an action is over.</p><p>The last step is to write Workflow. The configuration of Workflow is described in detail in <a href="#3-start-writing-the-first-workflow">Start Writing the First Workflow</a>, so I won&#x27;t repeat it here. The specific configuration is as follows：</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yml"><pre tabindex="0" class="prism-code language-yml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Auto close issue when PR is merged</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">on</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">pull_request_target</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">types</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> closed </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">jobs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">close-issue</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">runs-on</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">latest</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">steps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> actions/checkout@v2</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Auto issue closer&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ./.github/actions/Auto_close_associate_issue/</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Closer</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">with</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">prbody</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> github.event.pull_request.body </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Close Issue</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">uses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> peter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">evans/close</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">issue@v2</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">if</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> github.event.pull_request.merged </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">with</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">issue-number</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> steps.Closer.outputs.issueNumber </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">comment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> The associated PR has been merged</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> this issue is automatically closed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> you can reopend if necessary.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">Github_Token</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> secrets.GITHUB_TOKEN </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token key atrule">PRNUM</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> github.event.pull_request.number </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/github">github</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/page/2"><div class="pagination-nav__label">Older Entries »</div></a></div></nav></main></div></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Linkis</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/latest/introduction">Document</a></li><li class="footer__item"><a class="footer__link-item" href="/faq/main">FAQ</a></li><li class="footer__item"><a href="https://github.com/apache/incubator-linkis/releases" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Releases<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/apache/incubator-linkis" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/apache/incubator-linkis/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Issue Tracker<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/apache/incubator-linkis/pulls" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Pull Requests<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Subscribe Mailing List</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/community/how-to-subscribe">How to Subscribe</a></li><li class="footer__item"><a href="mailto:dev-subscribe@linkis.apache.org" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Subscribe Mail<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://lists.apache.org/list.html?dev@linkis.apache.org" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Mail Archive<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><div><img style="height:50px" alt="Apache Software Foundation" src="/img/incubator-logo.svg"><p style="color: #999999;  padding: 0 20px 30px;font-weight:400;text-align:left">Apache Linkis is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.</p><p></p>
             <p style="padding: 0 20px 30px;color: #999999;font-weight: 400;"> Copyright © 2022 The Apache Software Foundation. Licensed under the Apache License, Version 2.0. Apache Linkis, Apache Incubator, Apache, the Apache feather logo, the Apache Linkis logo and the Apache Incubator project logo are trademarks of The Apache Software Foundation.</p>
             <div></div></div></div></div></div></footer></div>
<script src="/assets/js/runtime~main.8c2fcd23.js"></script>
<script src="/assets/js/main.ffdafd4c.js"></script>
</body>
</html>